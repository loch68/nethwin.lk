<!-- Save as: print.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8" />
    <title>Print on Demand - NethwinLK</title>

    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?display=swap&family=Inter:wght@400;500;700;900&family=Noto+Sans:wght@400;500;700;900"
    />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="stylesheet" href="../css/hover-effects.css" />
    <link rel="stylesheet" href="../css/responsive.css" />
    <link rel="stylesheet" href="../css/navbar.css" />
    <link rel="stylesheet" href="../css/background-animations.css" />
    <style>
      :root {
        --primary-green: #0ad167;
        --dark-green: #1b5e20;
        --light-green: #e8f5e9;
        --accent-green: #19e619;
        --text-dark: #151612;
      }

      body {
        background: linear-gradient(
          135deg,
          #fdfefd 0%,
          #f8fbf8 30%,
          #f2f7f2 70%,
          #fafcfa 100%
        );
        min-height: 100vh;
      }

      /* Modern Navbar Styles */
      .modern-navbar {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        padding: 0.75rem 0;
      }

      .modern-navbar.scrolled {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(25px);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }

      .modern-navbar.hidden {
        transform: translateY(-100%);
      }

      .navbar-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 2rem;
        gap: 2rem;
      }

      .navbar-brand {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-weight: 700;
        color: #1b5e20;
        text-decoration: none;
      }

      .navbar-logo {
        height: 2.5rem;
        width: auto;
        transition: transform 0.3s ease;
      }

      .navbar-logo:hover {
        transform: scale(1.05);
      }

      .brand-text {
        font-size: 1.25rem;
        font-weight: 800;
        background: linear-gradient(135deg, #1b5e20, #0ad167);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .navbar-links {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        flex: 1;
        justify-content: center;
      }

      .nav-link {
        color: #1b5e20;
        text-decoration: none;
        font-weight: 500;
        font-size: 0.95rem;
        padding: 0.5rem 1rem;
        border-radius: 1.5rem;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        white-space: nowrap;
      }

      .nav-link::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(10, 209, 103, 0.1),
          transparent
        );
        transition: left 0.5s ease;
      }

      .nav-link:hover::before {
        left: 100%;
      }

      .nav-link:hover,
      .nav-link.active {
        color: #0ad167;
        background: rgba(10, 209, 103, 0.1);
        transform: translateY(-1px);
      }

      .navbar-auth {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        flex-shrink: 0;
      }

      .nav-auth-btn {
        display: inline-flex;
        align-items: center;
        padding: 0.5rem 1.25rem;
        background: rgba(10, 209, 103, 0.1);
        border: 1px solid rgba(10, 209, 103, 0.2);
        color: #1b5e20;
        text-decoration: none;
        border-radius: 1.5rem;
        font-weight: 600;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
      }

      .nav-auth-btn:hover {
        background: rgba(10, 209, 103, 0.2);
        border-color: rgba(10, 209, 103, 0.4);
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(10, 209, 103, 0.2);
        color: #0ad167;
      }

      .mobile-menu-toggle {
        display: none;
        flex-direction: column;
        gap: 0.25rem;
        background: none;
        border: none;
        cursor: pointer;
        padding: 0.5rem;
      }

      .hamburger-line {
        width: 1.5rem;
        height: 2px;
        background: #1b5e20;
        border-radius: 1px;
        transition: all 0.3s ease;
      }

      .mobile-menu-toggle.active .hamburger-line:nth-child(1) {
        transform: rotate(45deg) translate(0.35rem, 0.35rem);
      }

      .mobile-menu-toggle.active .hamburger-line:nth-child(2) {
        opacity: 0;
      }

      .mobile-menu-toggle.active .hamburger-line:nth-child(3) {
        transform: rotate(-45deg) translate(0.35rem, -0.35rem);
      }

      @media (max-width: 768px) {
        .navbar-container {
          padding: 0 1rem;
          justify-content: space-between;
        }

        /* Hide desktop navigation links on mobile */
        .navbar-links {
          position: fixed;
          top: 4rem;
          left: 0;
          right: 0;
          background: rgba(255, 255, 255, 0.98);
          backdrop-filter: blur(25px);
          flex-direction: column;
          padding: 2rem 0;
          gap: 1rem;
          transform: translateY(-100%);
          opacity: 0;
          visibility: hidden;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          border-bottom: 1px solid rgba(255, 255, 255, 0.2);
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
          z-index: 40;
        }

        .navbar-links.active {
          transform: translateY(0);
          opacity: 1;
          visibility: visible;
        }

        /* Hide desktop auth buttons on mobile */
        .navbar-auth {
          display: none;
        }

        /* Show mobile menu toggle */
        .mobile-menu-toggle {
          display: flex;
          z-index: 50;
        }

        /* Mobile-only auth icons */
        .mobile-auth-icons {
          display: flex;
          align-items: center;
          gap: 0.75rem;
        }

        .mobile-icon-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 2.5rem;
          height: 2.5rem;
          background: rgba(10, 209, 103, 0.1);
          border: 1px solid rgba(10, 209, 103, 0.2);
          border-radius: 50%;
          color: #1b5e20;
          text-decoration: none;
          transition: all 0.3s ease;
          backdrop-filter: blur(10px);
        }

        .mobile-icon-btn:hover {
          background: rgba(10, 209, 103, 0.2);
          border-color: rgba(10, 209, 103, 0.4);
          transform: scale(1.05);
          color: #0ad167;
        }
      }

      /* Background animations moved to background-animations.css */
      
      /* Print Page Animations */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      
      @keyframes fadeInLeft {
        from {
          opacity: 0;
          transform: translateX(-30px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      
      @keyframes fadeInRight {
        from {
          opacity: 0;
          transform: translateX(30px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      
      @keyframes scaleIn {
        from {
          opacity: 0;
          transform: scale(0.9);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      
      @keyframes slideInDown {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      
      @keyframes pulse {
        0%, 100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }
      
      @keyframes bounce {
        0%, 20%, 53%, 80%, 100% {
          transform: translate3d(0, 0, 0);
        }
        40%, 43% {
          transform: translate3d(0, -8px, 0);
        }
        70% {
          transform: translate3d(0, -4px, 0);
        }
        90% {
          transform: translate3d(0, -2px, 0);
        }
      }
      
      @keyframes shimmer {
        0% {
          background-position: -200px 0;
        }
        100% {
          background-position: calc(200px + 100%) 0;
        }
      }
      
      @keyframes float {
        0%, 100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
      }
      
      /* Animation Classes */
      .animate-fade-in-up {
        animation: fadeInUp 0.6s ease-out;
      }
      
      .animate-fade-in-left {
        animation: fadeInLeft 0.6s ease-out;
      }
      
      .animate-fade-in-right {
        animation: fadeInRight 0.6s ease-out;
      }
      
      .animate-scale-in {
        animation: scaleIn 0.5s ease-out;
      }
      
      .animate-slide-in-down {
        animation: slideInDown 0.5s ease-out;
      }
      
      .animate-pulse {
        animation: pulse 2s infinite;
      }
      
      .animate-bounce {
        animation: bounce 1s infinite;
      }
      
      .animate-float {
        animation: float 3s ease-in-out infinite;
      }
      
      .animate-shimmer {
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
        background-size: 200px 100%;
        animation: shimmer 2s infinite;
      }
      
      /* Staggered Animation Delays */
      .stagger-1 { animation-delay: 0.1s; }
      .stagger-2 { animation-delay: 0.2s; }
      .stagger-3 { animation-delay: 0.3s; }
      .stagger-4 { animation-delay: 0.4s; }
      .stagger-5 { animation-delay: 0.5s; }
      .stagger-6 { animation-delay: 0.6s; }
      
      /* Enhanced Form Styling */
      .form-input {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }
      
      .form-input:focus {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(10, 209, 103, 0.15);
        border-color: #0ad167;
      }
      
      .form-input:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 15px rgba(10, 209, 103, 0.1);
      }
      
      /* Enhanced Button Styling */
      .btn-primary {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }
      
      .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(10, 209, 103, 0.3);
      }
      
      .btn-primary:active {
        transform: translateY(-1px);
      }
      
      .btn-primary::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s ease;
      }
      
      .btn-primary:hover::before {
        left: 100%;
      }
      
      /* Enhanced Card Styling */
      .card {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }
      
      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      }
      
      .card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(10, 209, 103, 0.05), rgba(25, 230, 25, 0.05));
        opacity: 0;
        transition: opacity 0.3s ease;
        pointer-events: none;
      }
      
      .card:hover::before {
        opacity: 1;
      }
      
      /* File Upload Area Enhancements */
      .file-upload-area {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }
      
      .file-upload-area:hover {
        transform: scale(1.02);
        box-shadow: 0 10px 30px rgba(10, 209, 103, 0.2);
      }
      
      .file-upload-area.dragover {
        transform: scale(1.05);
        animation: pulse 0.5s ease-in-out;
      }
      
      /* Radio Button Enhancements */
      input[type="radio"] {
        transition: all 0.3s ease;
      }
      
      input[type="radio"]:checked {
        transform: scale(1.2);
      }
      
      /* Select Enhancements */
      select {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      select:focus {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(10, 209, 103, 0.15);
      }
      
      /* Textarea Enhancements */
      textarea {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        resize: none;
      }
      
      textarea:focus {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(10, 209, 103, 0.15);
      }
      
      /* Loading States */
      .loading {
        position: relative;
        overflow: hidden;
      }
      
      .loading::after {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
        animation: shimmer 1.5s infinite;
      }
      
      /* Success States */
      .success {
        animation: bounce 0.6s ease-in-out;
      }
      
      /* Error States */
      .error {
        animation: shake 0.5s ease-in-out;
      }
      
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-5px); }
        75% { transform: translateX(5px); }
      }
      
      /* Mobile Responsive Animations */
      @media (max-width: 768px) {
        .animate-fade-in-up,
        .animate-fade-in-left,
        .animate-fade-in-right {
          animation-duration: 0.4s;
        }
        
        .card:hover {
          transform: translateY(-2px);
        }
        
        .btn-primary:hover {
          transform: translateY(-2px);
        }
      }
      
      /* Intersection Observer Animation Classes */
      .animate-on-scroll {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      .animate-on-scroll.animated {
        opacity: 1;
        transform: translateY(0);
      }
      
      /* Smooth Page Transitions */
      .page-transition {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      /* Enhanced Navbar Animations */
      .modern-navbar {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      .nav-link {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
      }
      
      .nav-link::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 50%;
        width: 0;
        height: 2px;
        background: linear-gradient(90deg, #0ad167, #19e619);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        transform: translateX(-50%);
      }
      
      .nav-link:hover::after,
      .nav-link.active::after {
        width: 100%;
      }
      
      /* Enhanced Cart Count Animation */
      #cartCount, #mobileCartCount {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      #cartCount.updated, #mobileCartCount.updated {
        animation: bounce 0.6s ease-in-out;
        transform: scale(1.2);
      }
    </style>
  </head>
  <body>
    <div
      class="relative flex min-h-screen flex-col overflow-x-hidden font-[Inter, 'Noto Sans', sans-serif] modern-gradient"
    >
      <!-- Background Animation Container -->
      <div
        class="particles-container fixed inset-0 pointer-events-none z-0"
        id="particlesContainer"
      ></div>
      <!-- Modern Seamless Navbar -->
      <nav class="modern-navbar fixed top-0 left-0 right-0 z-30">
        <div class="navbar-container">
          <!-- Logo/Brand -->
          <div class="navbar-brand">
            <a href="index.html" class="flex items-center">
              <img
                src="../assets/fLogo.png"
                alt="NethwinLK"
                class="navbar-logo"
              />
            </a>
          </div>

          <!-- Navigation Links -->
          <div class="navbar-links" id="navbarLinks">
            <a href="index.html" class="nav-link">Home</a>
            <a href="print.html" class="nav-link active">Print Services</a>
            <a href="bookshop.html" class="nav-link">Bookshop</a>
            <a href="aboutus.html" class="nav-link">About</a>
            <a href="contactus.html" class="nav-link">Contact</a>
          </div>

          <!-- Desktop Auth Area -->
          <div class="navbar-auth" id="navbarAuth">
            <a href="cart.html" class="nav-auth-btn relative">
              <svg
                class="w-4 h-4 mr-2"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5H17M9 19.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM20.5 19.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"
                ></path>
              </svg>
              Cart
              <span id="cartCount" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold hidden">0</span>
            </a>
            <a href="search.html" class="nav-auth-btn">
              <svg
                class="w-4 h-4 mr-2"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              Search
            </a>
            <a href="login.html" class="nav-auth-btn">
              <svg
                class="w-4 h-4 mr-2"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013 3v1"
                ></path>
              </svg>
              Login
            </a>
          </div>

          <!-- Mobile Auth Icons (hidden on desktop) -->
          <div class="mobile-auth-icons hidden md:hidden">
            <a href="cart.html" class="mobile-icon-btn relative">
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5H17M9 19.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM20.5 19.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"
                ></path>
              </svg>
              <span id="mobileCartCount" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold hidden">0</span>
            </a>
            <a href="search.html" class="mobile-icon-btn">
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
            </a>
            <a href="login.html" class="mobile-icon-btn">
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013 3v1"
                ></path>
              </svg>
            </a>
          </div>

          <!-- Mobile Menu Toggle -->
          <button class="mobile-menu-toggle" id="mobileToggle">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </button>
        </div>
      </nav>

      <!-- Navbar Spacer -->
      <div style="height: 4rem"></div>

      <div class="layout-container flex flex-col grow h-full relative z-10">
        <!-- Form Starts Here -->
        <form
          id="printForm"
          class="px-4 sm:px-6 md:px-8 lg:px-16 xl:px-40 flex justify-center py-5 flex-1 page-transition"
          enctype="multipart/form-data"
        >
          <div class="flex flex-col max-w-[960px] flex-1 w-full">
            <div class="flex flex-wrap justify-between gap-3 p-2 sm:p-4 animate-fade-in-down">
              <p
                class="text-xl sm:text-2xl md:text-3xl lg:text-[32px] font-bold break-words animate-float"
              >
                Print Order Form
              </p>
            </div>

            <!-- Customer Information (only shown when not logged in) -->
            <div id="customerInfoSection" class="animate-fade-in-up stagger-1" style="display: none;">
              <h2
                class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-slide-in-down"
              >
                Customer Information
              </h2>

              <div
                class="flex max-w-full sm:max-w-[480px] flex-wrap items-end gap-4 px-2 sm:px-4 py-3"
              >
                <label class="flex flex-col w-full">
                  <p class="font-medium pb-2 text-sm sm:text-base">
                    Full Name *
                  </p>
                  <input
                    type="text"
                    name="userName"
                    placeholder="Enter your full name"
                    class="form-input w-full h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                  />
                </label>
              </div>

              <div
                class="flex max-w-full sm:max-w-[480px] flex-wrap items-end gap-4 px-2 sm:px-4 py-3"
              >
                <label class="flex flex-col w-full">
                  <p class="font-medium pb-2 text-sm sm:text-base">
                    Email Address *
                  </p>
                  <input
                    type="email"
                    name="email"
                    placeholder="Enter your email address"
                    class="form-input w-full h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                  />
                </label>
              </div>

              <div
                class="flex max-w-full sm:max-w-[480px] flex-wrap items-end gap-4 px-2 sm:px-4 py-3"
              >
                <label class="flex flex-col w-full">
                  <p class="font-medium pb-2 text-sm sm:text-base">
                    Contact Number *
                  </p>
                  <input
                    type="tel"
                    name="contactNumber"
                    placeholder="Enter your contact number"
                    class="form-input w-full h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                  />
                </label>
              </div>
            </div>

            <!-- Logged in user info display -->
            <div id="loggedInUserInfo" class="animate-fade-in-up stagger-1" style="display: none;">
              <h2
                class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-slide-in-down"
              >
                Account Information
              </h2>
              <div class="px-2 sm:px-4 py-3">
                <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 card animate-scale-in">
                  <p class="text-sm font-medium text-gray-700 mb-2">Ordering as:</p>
                  <p class="text-lg font-semibold text-blue-600" id="userDisplayName"></p>
                  <p class="text-sm text-gray-600" id="userDisplayEmail"></p>
                  <p class="text-sm text-gray-600" id="userDisplayPhone"></p>
                </div>
              </div>
              
              <!-- Hidden fields for logged-in users -->
              <input type="hidden" name="userName" id="hiddenUserName" required>
              <input type="hidden" name="email" id="hiddenEmail" required>
              <input type="hidden" name="contactNumber" id="hiddenContactNumber" required>
            </div>

            <!-- Login prompt for non-logged in users -->
            <div id="loginPrompt" class="animate-fade-in-up stagger-1" style="display: none;">
              <div class="px-2 sm:px-4 py-3">
                <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4 card animate-scale-in">
                  <div class="flex items-center justify-between">
                    <div>
                      <p class="text-sm font-medium text-yellow-800 mb-1">
                        Have an account?
                      </p>
                      <p class="text-xs text-yellow-600">
                        Login to skip filling customer information
                      </p>
                    </div>
                    <a 
                      href="login.html" 
                      class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"
                    >
                      Login
                    </a>
                  </div>
                </div>
              </div>
            </div>

            <!-- Document Upload -->
            <h2
              class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-fade-in-up stagger-2"
            >
              Document Upload
            </h2>

            <div class="flex flex-col p-4 sm:p-6 animate-fade-in-up stagger-3">
              <label
                for="document"
                class="file-upload-area flex flex-col items-center justify-center gap-4 sm:gap-6 rounded-xl border-2 border-dashed border-gray-300 hover:border-green-500 transition-colors duration-300 cursor-pointer bg-gray-50 hover:bg-green-50 px-6 py-10 sm:py-14 text-center"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-12 w-12 text-green-500"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M4 16v4h16v-4M12 12v8m0-8l4 4m-4-4l-4 4m0-8h.01M20 8V6a2 2 0 00-2-2H6a2 2 0 00-2 2v2"
                  />
                </svg>
                <div>
                  <p class="text-base sm:text-lg font-semibold text-gray-700">
                    Drag & Drop your document here
                  </p>
                  <p class="text-xs sm:text-sm text-gray-500 mt-1">
                    or click to browse (PDF, DOC, DOCX, TXT, JPG, JPEG, PNG, GIF)
                  </p>
                  <p class="text-xs text-red-500 mt-1">
                    Maximum file size: 10MB
                  </p>
                </div>
                <input
                  type="file"
                  id="document"
                  name="document"
                  accept=".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.gif"
                  required
                  class="hidden"
                />
              </label>
            </div>

            <!-- Document Preview -->
            <h2
              class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-fade-in-up stagger-4"
            >
              Document Preview
            </h2>
            <div
              id="previewContainer"
              class="p-2 sm:p-4 animate-fade-in-up stagger-5"
            >
              <div id="noFileMessage" class="text-center text-gray-500 py-8">
                <svg class="mx-auto h-12 w-12 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <p>No document selected</p>
              </div>
              <div id="filePreview" class="hidden">
                <div class="bg-white border border-gray-200 rounded-lg p-4">
                  <div class="flex items-center justify-between mb-2">
                    <h3 class="font-medium text-gray-900" id="fileName"></h3>
                    <button 
                      id="removeFile" 
                      class="text-red-500 hover:text-red-700 text-sm font-medium"
                    >
                      Remove
                    </button>
                  </div>
                  <div id="filePreviewContent" class="mt-2"></div>
                  <p class="text-xs text-gray-500 mt-2" id="fileSize"></p>
                </div>
              </div>
            </div>

            <!-- Print Options -->
            <h2
              class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-fade-in-up stagger-6"
            >
              Print Specifications
            </h2>

            <div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3 animate-fade-in-left stagger-1"
            >
              <label class="flex flex-col w-full">
                <p class="pb-2 font-medium text-sm sm:text-base">Paper Size *</p>
                <select
                  name="paperSize"
                  required
                  class="form-input h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                >
                  <option value="">Select Paper Size</option>
                  <option value="A6">A6</option>
                  <option value="A5">A5</option>
                  <option value="A4">A4</option>
                  <option value="A3">A3</option>
                  <option value="A2">A2</option>
                  <option value="A1">A1</option>
                </select>
              </label>
            </div>

            <div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3 animate-fade-in-right stagger-2"
            >
              <label class="flex flex-col w-full">
                <p class="pb-2 font-medium text-sm sm:text-base">Color Option *</p>
                <select
                  name="colorOption"
                  required
                  class="form-input h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                >
                  <option value="">Select Color Option</option>
                  <option value="normal_color">Normal Color</option>
                  <option value="laser_color">Laser Color</option>
                  <option value="bw_single">Black & White (Single-sided)</option>
                  <option value="bw_double">Black & White (Double-sided)</option>
                </select>
              </label>
            </div>

            <div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3 animate-fade-in-left stagger-3"
            >
              <label class="flex flex-col w-full">
                <p class="pb-2 font-medium text-sm sm:text-base">Binding *</p>
                <select
                  name="binding"
                  required
                  class="form-input h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                >
                  <option value="">Select Binding</option>
                  <option value="None">None</option>
                  <option value="Spiral Binding">Spiral Binding</option>
                  <option value="Thermal Binding">Thermal Binding</option>
                  <option value="Hardcover Binding">Hardcover Binding</option>
                  <option value="Saddle Stitching">Saddle Stitching</option>
                </select>
              </label>
            </div>

            <div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3 animate-fade-in-right stagger-4"
            >
              <label class="flex flex-col w-full">
                <p class="pb-2 font-medium text-sm sm:text-base">
                  Number of Copies *
                </p>
                <input
                  type="number"
                  name="copies"
                  min="1"
                  value="1"
                  required
                  class="form-input h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                />
              </label>
            </div>

            <div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3 animate-fade-in-left stagger-5"
            >
              <label class="flex flex-col w-full">
                <p class="pb-2 font-medium text-sm sm:text-base">Finishing *</p>
                <select
                  name="finishing"
                  required
                  class="form-input h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                >
                  <option value="">Select Finishing</option>
                  <option value="None">None</option>
                  <option value="Lamination (Gloss)">Lamination (Gloss)</option>
                  <option value="Lamination (Matte)">Lamination (Matte)</option>
                  <option value="Foil Stamping">Foil Stamping</option>
                  <option value="Embossing/Debossing">Embossing/Debossing</option>
                  <option value="Die-Cutting">Die-Cutting</option>
                  <option value="custom">Custom (Specify in notes)</option>
                </select>
              </label>
            </div>

            <div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3 animate-fade-in-right stagger-6"
              id="additionalNotesContainer"
              style="display: none;"
            >
              <label class="flex flex-col w-full">
                <p class="pb-2 font-medium text-sm sm:text-base">Additional Notes *</p>
                <textarea
                  name="additionalNotes"
                  placeholder="Please describe your custom finishing requirements"
                  rows="3"
                  class="form-input w-full p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base resize-none"
                ></textarea>
              </label>
            </div>

            <!-- Delivery Options -->
            <h2
              class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-fade-in-up stagger-1"
            >
              Delivery Options
            </h2>
            <div class="flex flex-col gap-3 p-2 sm:p-4 animate-fade-in-up stagger-2">
              <label
                class="flex items-center gap-3 sm:gap-4 border p-3 sm:p-[15px] rounded-xl border-[#dbdfe6]"
              >
                <input
                  type="radio"
                  name="deliveryMethod"
                  value="Home Delivery"
                  required
                  class="h-4 w-4 sm:h-5 sm:w-5"
                />
                <span class="text-xs sm:text-sm font-medium">
                  Home Delivery (<span id="printDeliveryPrice">LKR 0.00</span>) - Within <span id="printDeliveryRadius">10</span>km
                </span>
              </label>
              <label
                class="flex items-center gap-3 sm:gap-4 border p-3 sm:p-[15px] rounded-xl border-[#dbdfe6]"
              >
                <input
                  type="radio"
                  name="deliveryMethod"
                  value="Pickup"
                  required
                  class="h-4 w-4 sm:h-5 sm:w-5"
                />
                <span class="text-xs sm:text-sm font-medium">Store Pickup (Free)</span>
              </label>
            </div>

            <div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3"
            >
              <label class="flex flex-col w-full">
                <p class="pb-2 font-medium text-sm sm:text-base">Delivery Address *</p>
                <textarea
                  name="deliveryAddress"
                  placeholder="Enter your delivery address"
                  rows="3"
                  required
                  class="form-input w-full p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base resize-none"
                ></textarea>
              </label>
            </div>

            <!-- Pricing Info -->
            <h2
              class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-fade-in-up stagger-3"
            >
              Pricing
            </h2>
            <div class="px-2 sm:px-4 py-3 animate-fade-in-up stagger-4">
              <div class="bg-green-50 border border-green-200 rounded-xl p-4 card animate-pulse">
                <p class="text-sm sm:text-base font-medium text-gray-700 mb-2">
                  Estimated Price:
                </p>
                <p class="text-2xl sm:text-3xl font-bold text-green-600" id="estimatedPrice">
                  Rs. 0
                </p>
                <p class="text-xs text-gray-500 mt-1">
                  * Final price may vary based on actual requirements
                </p>
              </div>
            </div>

            <!-- Action Buttons -->
            <div
              class="flex flex-col sm:flex-row justify-between gap-3 px-2 sm:px-4 py-3 animate-fade-in-up stagger-5"
            >
              <div class="flex flex-col sm:flex-row gap-3 w-full sm:w-auto">
                <a href="index.html" class="btn-primary"> Back to Home </a>
              </div>

              <div class="flex flex-col sm:flex-row gap-3 w-full sm:w-auto">
                <button type="button" id="submitPrintOrder" class="btn-primary w-full sm:w-auto">
                  Submit Print Order
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
    <script>
      // Pricing data (matches backend)
      const pricingData = {
        paperSizes: [
          { size: "A6", normal_color: 20, laser_color: 65, bw_single: 5, bw_double: 5 },
          { size: "A5", normal_color: 40, laser_color: 125, bw_single: 5, bw_double: 10 },
          { size: "A4", normal_color: 75, laser_color: 250, bw_single: 5, bw_double: 10 },
          { size: "A3", normal_color: 150, laser_color: 500, bw_single: 10, bw_double: 15 },
          { size: "A2", normal_color: 300, laser_color: 1000, bw_single: 15, bw_double: 30 },
          { size: "A1", normal_color: 600, laser_color: 2000, bw_single: 30, bw_double: 65 }
        ],
        binding: [
          { type: "Spiral Binding", price: 50 },
          { type: "Thermal Binding", price: 150 },
          { type: "Hardcover Binding", price: 500 },
          { type: "Saddle Stitching", price: 30 }
        ],
        finishing: [
          { type: "Lamination (Gloss)", price: 50 },
          { type: "Lamination (Matte)", price: 50 },
          { type: "Foil Stamping", price: 100 },
          { type: "Embossing/Debossing", price: 150 },
          { type: "Die-Cutting", price: 200 }
        ],
        delivery: [
          { type: "Home Delivery", price: 0 }, // Will be updated dynamically
          { type: "Pickup", price: 0 }
        ]
      };

      // Calculate price based on selections
      function calculatePrice() {
        const paperSize = document.querySelector('select[name="paperSize"]').value;
        const colorOption = document.querySelector('select[name="colorOption"]').value;
        const copies = parseInt(document.querySelector('input[name="copies"]').value) || 1;
        const binding = document.querySelector('select[name="binding"]').value;
        const finishing = document.querySelector('select[name="finishing"]').value;
        const deliveryMethod = document.querySelector('input[name="deliveryMethod"]:checked')?.value;

        if (!paperSize || !colorOption || !binding || !finishing || !deliveryMethod) {
          document.getElementById('estimatedPrice').textContent = 'Rs. 0';
          return 0;
        }

        let totalPrice = 0;

        // Find paper size pricing
        const sizeData = pricingData.paperSizes.find(s => s.size === paperSize);
        if (sizeData) {
          let printCostPerCopy = 0;
          switch (colorOption) {
            case 'normal_color':
              printCostPerCopy = sizeData.normal_color;
              break;
            case 'laser_color':
              printCostPerCopy = sizeData.laser_color;
              break;
            case 'bw_single':
              printCostPerCopy = sizeData.bw_single;
              break;
            case 'bw_double':
              printCostPerCopy = sizeData.bw_double;
              break;
          }
          totalPrice += printCostPerCopy * copies;
        }

        // Add binding cost (skip if "None")
        if (binding && binding !== "None") {
          const bindingData = pricingData.binding.find(b => b.type === binding);
          if (bindingData) {
            totalPrice += bindingData.price;
          }
        }

        // Add finishing cost (skip if "None")
        if (finishing && finishing !== "None") {
          const finishingData = pricingData.finishing.find(f => f.type === finishing);
          if (finishingData) {
            totalPrice += finishingData.price;
          }
        }

        // Add delivery cost
        const deliveryData = pricingData.delivery.find(d => d.type === deliveryMethod);
        if (deliveryData) {
          totalPrice += deliveryData.price;
        }

        document.getElementById('estimatedPrice').textContent = `Rs. ${totalPrice}`;
        animatePriceChange();
        return totalPrice;
      }

      // Check authentication and setup form
      async function setupFormForUser() {
        const token = localStorage.getItem('authToken');
        const customerInfoSection = document.getElementById('customerInfoSection');
        const loggedInUserInfo = document.getElementById('loggedInUserInfo');
        const loginPrompt = document.getElementById('loginPrompt');
        
        if (token) {
          try {
            // Decode token to get user info
            const payload = JSON.parse(atob(token.split('.')[1]));
            const userId = payload.sub;
            
            // Fetch user details from API
            const response = await fetch('/api/me', {
              headers: {
                'Authorization': `Bearer ${token}`
              }
            });
            
            if (response.ok) {
              const data = await response.json();
              const user = data.user;
              
              // Debug: Log user data
              console.log('User data received:', user);
              console.log('Available user fields:', Object.keys(user));
              console.log('Full user object:', JSON.stringify(user, null, 2));
              
              // Hide customer info section and login prompt, show logged in user info
              customerInfoSection.style.display = 'none';
              loginPrompt.style.display = 'none';
              loggedInUserInfo.style.display = 'block';
              
              // Get contact number from user data - check all possible field names
              const contactNumber = user.phoneNumber || user.phone || user.contactNumber || user.mobile || '';
              console.log('Contact number found:', contactNumber);
              console.log('phoneNumber:', user.phoneNumber);
              console.log('phone:', user.phone);
              console.log('contactNumber:', user.contactNumber);
              
              // Populate user display with complete profile information
              document.getElementById('userDisplayName').textContent = user.fullName || 'User';
              document.getElementById('userDisplayEmail').textContent = user.email || '';
              document.getElementById('userDisplayPhone').textContent = contactNumber || user.phoneNumber || 'Not provided';
              
              // Show additional user details if available
              const userDetails = document.getElementById('userDisplayPhone');
              if (user.address) {
                userDetails.innerHTML += `<br><span class="text-sm text-gray-600">Address: ${user.address}</span>`;
              }
              if (user.city) {
                userDetails.innerHTML += `<br><span class="text-sm text-gray-600">City: ${user.city}</span>`;
              }
              
              // Pre-populate hidden form fields with user data
              document.getElementById('hiddenUserName').value = user.fullName || '';
              document.getElementById('hiddenEmail').value = user.email || '';
              document.getElementById('hiddenContactNumber').value = contactNumber;
              
              // For logged-in users, we don't need to show customer info section
              // They can only change delivery information
              // All user details are automatically taken from the database
              
              // If contact number is still empty, show customer info section as fallback
              if (!contactNumber) {
                console.warn('User does not have contact number in profile, showing customer info section');
                document.getElementById('customerInfoSection').style.display = 'block';
                document.getElementById('loggedInUserInfo').style.display = 'none';
                // Make contact number required
                document.querySelector('input[name="contactNumber"]').required = true;
              }
              
              // Remove required attribute from visible fields since we're using hidden ones
              document.querySelector('input[name="userName"]').required = false;
              document.querySelector('input[name="email"]').required = false;
              document.querySelector('input[name="contactNumber"]').required = false;
              
            } else {
              // Token invalid, show customer info section and login prompt
              customerInfoSection.style.display = 'block';
              loggedInUserInfo.style.display = 'none';
              loginPrompt.style.display = 'block';
              
              // Make sure form fields are required for non-logged-in users
              document.querySelector('input[name="userName"]').required = true;
              document.querySelector('input[name="email"]').required = true;
              document.querySelector('input[name="contactNumber"]').required = true;
            }
          } catch (error) {
            console.warn('Could not fetch user data:', error);
            // Show customer info section and login prompt as fallback
            customerInfoSection.style.display = 'block';
            loggedInUserInfo.style.display = 'none';
            loginPrompt.style.display = 'block';
            
            // Make sure form fields are required for non-logged-in users
            document.querySelector('input[name="userName"]').required = true;
            document.querySelector('input[name="email"]').required = true;
            document.querySelector('input[name="contactNumber"]').required = true;
          }
        } else {
          // No token, show customer info section and login prompt
          customerInfoSection.style.display = 'block';
          loggedInUserInfo.style.display = 'none';
          loginPrompt.style.display = 'block';
          
          // Make sure form fields are required for non-logged-in users
          document.querySelector('input[name="userName"]').required = true;
          document.querySelector('input[name="email"]').required = true;
          document.querySelector('input[name="contactNumber"]').required = true;
        }
      }

      // Scroll-triggered animations
      function initScrollAnimations() {
        const observerOptions = {
          threshold: 0.1,
          rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('animated');
            }
          });
        }, observerOptions);

        // Observe all elements with animate-on-scroll class
        document.querySelectorAll('.animate-on-scroll').forEach(el => {
          observer.observe(el);
        });
      }

      // Enhanced form interactions
      function initFormAnimations() {
        // Add loading states to form inputs
        const formInputs = document.querySelectorAll('.form-input');
        formInputs.forEach(input => {
          input.addEventListener('focus', function() {
            this.parentElement.classList.add('animate-scale-in');
          });
          
          input.addEventListener('blur', function() {
            this.parentElement.classList.remove('animate-scale-in');
          });
        });

        // Add success/error animations to buttons
        const buttons = document.querySelectorAll('.btn-primary');
        buttons.forEach(button => {
          button.addEventListener('click', function() {
            this.classList.add('animate-bounce');
            setTimeout(() => {
              this.classList.remove('animate-bounce');
            }, 600);
          });
        });

        // Add hover effects to cards
        const cards = document.querySelectorAll('.card');
        cards.forEach(card => {
          card.addEventListener('mouseenter', function() {
            this.classList.add('animate-float');
          });
          
          card.addEventListener('mouseleave', function() {
            this.classList.remove('animate-float');
          });
        });
      }

      // Enhanced file upload animations
      function initFileUploadAnimations() {
        const fileInput = document.getElementById('document');
        const dropZone = fileInput.parentElement;

        // Add dragover animation
        dropZone.addEventListener('dragover', function() {
          this.classList.add('dragover', 'animate-pulse');
        });

        dropZone.addEventListener('dragleave', function() {
          this.classList.remove('dragover', 'animate-pulse');
        });

        dropZone.addEventListener('drop', function() {
          this.classList.remove('dragover', 'animate-pulse');
          this.classList.add('success');
          setTimeout(() => {
            this.classList.remove('success');
          }, 600);
        });

        // File selection animation
        fileInput.addEventListener('change', function() {
          if (this.files.length > 0) {
            dropZone.classList.add('success');
            setTimeout(() => {
              dropZone.classList.remove('success');
            }, 600);
          }
        });
      }

      // Price calculation with animation
      function animatePriceChange() {
        const priceElement = document.getElementById('estimatedPrice');
        if (priceElement) {
          priceElement.classList.add('animate-bounce');
          setTimeout(() => {
            priceElement.classList.remove('animate-bounce');
          }, 600);
        }
      }

      // Enhanced cart count animation
      function animateCartUpdate() {
        const cartCount = document.getElementById('cartCount');
        const mobileCartCount = document.getElementById('mobileCartCount');
        
        if (cartCount) {
          cartCount.classList.add('updated');
          setTimeout(() => {
            cartCount.classList.remove('updated');
          }, 600);
        }
        
        if (mobileCartCount) {
          mobileCartCount.classList.add('updated');
          setTimeout(() => {
            mobileCartCount.classList.remove('updated');
          }, 600);
        }
      }

      // Add event listeners for price calculation
      document.addEventListener('DOMContentLoaded', function() {
        // Initialize animations
        initScrollAnimations();
        initFormAnimations();
        initFileUploadAnimations();
        
        // Setup form based on authentication state
        setupFormForUser();
        
        const priceInputs = [
          'select[name="paperSize"]',
          'select[name="colorOption"]',
          'input[name="copies"]',
          'select[name="binding"]',
          'select[name="finishing"]',
          'input[name="deliveryMethod"]'
        ];

        priceInputs.forEach(selector => {
          const elements = document.querySelectorAll(selector);
          elements.forEach(element => {
            element.addEventListener('change', calculatePrice);
            element.addEventListener('input', calculatePrice);
          });
        });

        // Show/hide additional notes based on finishing selection
        const finishingSelect = document.querySelector('select[name="finishing"]');
        const additionalNotesContainer = document.getElementById('additionalNotesContainer');
        
        finishingSelect.addEventListener('change', function() {
          if (this.value === 'custom') {
            additionalNotesContainer.style.display = 'block';
            additionalNotesContainer.querySelector('textarea').required = true;
          } else {
            additionalNotesContainer.style.display = 'none';
            additionalNotesContainer.querySelector('textarea').required = false;
          }
        });
      });

      // File upload handling
      const fileInput = document.getElementById('document');
      const dropZone = fileInput.parentElement;

      // Prevent default browser behavior for the whole page
      ["dragenter", "dragover", "dragleave", "drop"].forEach((eventName) => {
        document.addEventListener(eventName, (e) => e.preventDefault());
      });

      // Add visual feedback when dragging
      document.addEventListener("dragover", () =>
        dropZone.classList.add("border-green-500", "bg-green-50")
      );
      document.addEventListener("dragleave", () =>
        dropZone.classList.remove("border-green-500", "bg-green-50")
      );

      // Handle dropped files
      document.addEventListener("drop", (e) => {
        const droppedFiles = Array.from(e.dataTransfer.files);
        if (droppedFiles.length > 0) {
          fileInput.files = droppedFiles[0]; // Only take first file
        }
        dropZone.classList.remove("border-green-500", "bg-green-50");
      });

      // File input change
      fileInput.addEventListener('change', function() {
        if (this.files.length > 0) {
          showFilePreview(this.files[0]);
        } else {
          hideFilePreview();
        }
      });

      // Show file preview
      function showFilePreview(file) {
        const noFileMessage = document.getElementById('noFileMessage');
        const filePreview = document.getElementById('filePreview');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        const filePreviewContent = document.getElementById('filePreviewContent');

        // Hide no file message and show preview
        noFileMessage.style.display = 'none';
        filePreview.classList.remove('hidden');

        // Set file name and size
        fileName.textContent = file.name;
        fileSize.textContent = `Size: ${(file.size / 1024 / 1024).toFixed(2)} MB`;

        // Create preview based on file type
        filePreviewContent.innerHTML = '';
        
        if (file.type.startsWith('image/')) {
          const img = document.createElement('img');
          img.src = URL.createObjectURL(file);
          img.className = 'w-full h-48 object-cover rounded-lg';
          img.alt = file.name;
          filePreviewContent.appendChild(img);
        } else if (file.type === 'application/pdf') {
          const pdfIcon = document.createElement('div');
          pdfIcon.className = 'flex items-center justify-center h-32 bg-red-50 rounded-lg';
          pdfIcon.innerHTML = `
            <div class="text-center">
              <svg class="mx-auto h-12 w-12 text-red-500 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
              </svg>
              <p class="text-red-600 font-medium">PDF Document</p>
            </div>
          `;
          filePreviewContent.appendChild(pdfIcon);
        } else if (file.type.includes('word') || file.type.includes('document')) {
          const docIcon = document.createElement('div');
          docIcon.className = 'flex items-center justify-center h-32 bg-blue-50 rounded-lg';
          docIcon.innerHTML = `
            <div class="text-center">
              <svg class="mx-auto h-12 w-12 text-blue-500 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              <p class="text-blue-600 font-medium">Word Document</p>
            </div>
          `;
          filePreviewContent.appendChild(docIcon);
        } else {
          const genericIcon = document.createElement('div');
          genericIcon.className = 'flex items-center justify-center h-32 bg-gray-50 rounded-lg';
          genericIcon.innerHTML = `
            <div class="text-center">
              <svg class="mx-auto h-12 w-12 text-gray-500 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              <p class="text-gray-600 font-medium">Document</p>
            </div>
          `;
          filePreviewContent.appendChild(genericIcon);
        }

        // Add remove file functionality
        const removeFileBtn = document.getElementById('removeFile');
        if (removeFileBtn) {
          removeFileBtn.addEventListener('click', function() {
            fileInput.value = '';
            hideFilePreview();
          });
        }
      }

      // Hide file preview
      function hideFilePreview() {
        const noFileMessage = document.getElementById('noFileMessage');
        const filePreview = document.getElementById('filePreview');
        
        noFileMessage.style.display = 'block';
        filePreview.classList.add('hidden');
      }
    </script>

    <script>
      // Update cart count function
      function updateCartCount() {
        try {
          const cart = JSON.parse(localStorage.getItem("nethwin_cart") || "[]");
          const totalItems = cart.reduce((sum, item) => sum + (item.qty || item.quantity || 1), 0);
          
          const cartCount = document.getElementById('cartCount');
          const mobileCartCount = document.getElementById('mobileCartCount');
          
          if (totalItems > 0) {
            if (cartCount) {
              cartCount.textContent = totalItems;
              cartCount.classList.remove('hidden');
              animateCartUpdate();
            }
            if (mobileCartCount) {
              mobileCartCount.textContent = totalItems;
              mobileCartCount.classList.remove('hidden');
              animateCartUpdate();
            }
          } else {
            if (cartCount) {
              cartCount.classList.add('hidden');
            }
            if (mobileCartCount) {
              mobileCartCount.classList.add('hidden');
            }
          }
        } catch (e) {
          console.warn("Could not update cart count:", e);
        }
      }

      // Navbar interactions
      document.addEventListener("DOMContentLoaded", () => {
        const mobileToggle = document.getElementById("mobileToggle");
        const navbarLinks = document.getElementById("navbarLinks");
        const navbar = document.querySelector(".modern-navbar");
        
        // Update cart count on page load
        updateCartCount();

        // Mobile menu toggle handled by navbar.js

        // Mobile auth visibility handled by navbar.js

        // Navbar scroll effect (only add scrolled class, no hiding)
        window.addEventListener("scroll", () => {
          const currentScrollY = window.scrollY;

          if (currentScrollY > 100) {
            navbar.classList.add("scrolled");
          } else {
            navbar.classList.remove("scrolled");
          }
        });

        // Auth system
        try {
          const token = localStorage.getItem("authToken");
          const navbarAuth = document.getElementById("navbarAuth");

          if (token && navbarAuth) {
            const loginBtn = navbarAuth.querySelector('a[href="login.html"]');
            if (loginBtn) {
              loginBtn.innerHTML = `
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
                Profile
              `;
              loginBtn.href = "profile.html";
            }
          }
        } catch (error) {
          console.warn("Auth system initialization failed:", error);
        }

        // Background Animation System - now using shared module
        // Animations will be auto-initialized by background-animations.js
      });
    </script>

    <script src="../javascript/navbar.js"></script>
    <script src="../javascript/background-animations.js"></script>

    <script>
      // Print order submission handler
      document.getElementById("submitPrintOrder").addEventListener("click", async function (e) {
        e.preventDefault();
        e.stopPropagation();
          
          console.log('Print order submission started');
          
          const form = document.getElementById("printForm");
          
          // Check if form is valid before proceeding
          if (!form.checkValidity()) {
            console.log('Form validation failed');
            // Find the first invalid field and focus on it
            const firstInvalid = form.querySelector(':invalid');
            if (firstInvalid) {
              firstInvalid.focus();
              firstInvalid.reportValidity();
            }
            return;
          }
          
          console.log('Form validation passed, preparing data');
          const formData = new FormData();
          
          // Add all form fields
          const token = localStorage.getItem('authToken');
          if (token) {
            // User is logged in - use their complete profile data from database
            // But if contact number is empty, use visible field (fallback case)
            const contactNumber = document.getElementById('hiddenContactNumber').value || form.contactNumber.value;
            
            formData.append('userName', document.getElementById('hiddenUserName').value);
            formData.append('email', document.getElementById('hiddenEmail').value);
            formData.append('contactNumber', contactNumber);
            
            // Add userId for backend reference
            try {
              const payload = JSON.parse(atob(token.split('.')[1]));
              formData.append('userId', payload.sub);
            } catch (e) {
              console.warn('Could not extract userId from token');
            }
          } else {
            // User is not logged in - use visible form fields
            const userNameField = form.querySelector('input[name="userName"]');
            const emailField = form.querySelector('input[name="email"]');
            const contactNumberField = form.querySelector('input[name="contactNumber"]');
            
            console.log('Non-logged-in user form fields debug:');
            console.log('userName field found:', !!userNameField);
            console.log('email field found:', !!emailField);
            console.log('contactNumber field found:', !!contactNumberField);
            
            if (userNameField) console.log('userName value:', userNameField.value);
            if (emailField) console.log('email value:', emailField.value);
            if (contactNumberField) console.log('contactNumber value:', contactNumberField.value);
            
            formData.append('userName', userNameField ? userNameField.value : '');
            formData.append('email', emailField ? emailField.value : '');
            formData.append('contactNumber', contactNumberField ? contactNumberField.value : '');
          }
          formData.append('paperSize', form.querySelector('select[name="paperSize"]').value);
          formData.append('colorOption', form.querySelector('select[name="colorOption"]').value);
          formData.append('binding', form.querySelector('select[name="binding"]').value);
          formData.append('copies', form.querySelector('input[name="copies"]').value);
          formData.append('finishing', form.querySelector('select[name="finishing"]').value);
          formData.append('deliveryMethod', form.querySelector('input[name="deliveryMethod"]:checked').value);
          formData.append('deliveryAddress', form.querySelector('textarea[name="deliveryAddress"]').value);
          
          // Add additional notes if custom finishing
          if (form.querySelector('select[name="finishing"]').value === 'custom' && form.querySelector('textarea[name="additionalNotes"]').value) {
            formData.append('additionalNotes', form.querySelector('textarea[name="additionalNotes"]').value);
          }
          
          // Add file
          const documentInput = form.querySelector('input[name="document"]');
          if (documentInput && documentInput.files.length > 0) {
            formData.append('document', documentInput.files[0]);
          }

          // Debug: Log form data being sent
          console.log('Form data being sent:');
          for (let [key, value] of formData.entries()) {
            console.log(key + ':', value);
          }

          try {
            console.log('Sending request to /api/print-orders');
            const response = await fetch("/api/print-orders", {
              method: "POST",
              body: formData
            });
            
            console.log('Response received:', response.status, response.statusText);
            const result = await response.json();
            console.log('Response data:', result);
            
            if (response.ok && result.success) {
              alert("Print order submitted successfully! Order ID: " + result.data._id);
              form.reset();
              document.getElementById('estimatedPrice').textContent = 'Rs. 0';
              document.getElementById('additionalNotesContainer').style.display = 'none';
            } else {
              // Show detailed validation errors
              let errorMessage = result.error || 'Failed to submit print order';
              if (result.details && result.details.length > 0) {
                errorMessage += '\n\nValidation errors:\n';
                result.details.forEach(error => {
                  errorMessage += `- ${error.msg} (field: ${error.param})\n`;
                });
              }
              throw new Error(errorMessage);
            }
          } catch (err) {
            console.error('Print order submission error:', err);
            alert("Failed to submit print order: " + err.message);
          }
        });

        // Delivery pricing management
        function getDeliveryPrice() {
            try {
                const settings = JSON.parse(localStorage.getItem('nethwin_delivery_settings') || '{}');
                return settings.localDeliveryPrice || 0;
            } catch {
                return 0;
            }
        }

        function updateDeliveryPrice() {
            const price = getDeliveryPrice();
            const priceElement = document.getElementById('printDeliveryPrice');
            if (priceElement) {
                if (price > 0) {
                    priceElement.textContent = `LKR ${price.toFixed(2)}`;
                } else {
                    priceElement.textContent = 'Free';
                }
            }
            
            // Update pricing data
            pricingData.delivery[0].price = price;
        }

        function loadDeliverySettings() {
            updateDeliveryPrice();
            updateDeliveryRadius();
        }

        function updateDeliveryRadius() {
            try {
                const settings = JSON.parse(localStorage.getItem('nethwin_delivery_settings') || '{}');
                const radius = settings.deliveryRadius || 10;
                
                const radiusElement = document.getElementById('printDeliveryRadius');
                if (radiusElement) {
                    radiusElement.textContent = radius;
                }
            } catch (e) {
                console.error('Error updating delivery radius:', e);
            }
        }

        // Listen for delivery settings updates from admin panel
        window.addEventListener('deliverySettingsUpdated', function(event) {
            console.log('Delivery settings updated, refreshing print page...');
            loadDeliverySettings();
        });

        // Load delivery settings on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadDeliverySettings();
        });
    </script>
  </body>
</html>
