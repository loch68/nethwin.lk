<!-- Save as: print.html --><!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width, initial-scale=1" /><meta charset="UTF-8" /><title>Print on Demand - NethwinLK</title><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" /><link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?display=swap&family=Inter:wght@400;500;700;900&family=Noto+Sans:wght@400;500;700;900"
    /><script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        // Suppress Tailwind CDN warnings for development
        const originalWarn = console.warn;
        console.warn = function(message) {
            if (message && typeof message === 'string' && 
                (message.includes('cdn.tailwindcss.com should not be used in production') ||
                 message.includes('Components object is deprecated'))) {
                return; // Suppress these specific warnings
            }
            originalWarn.apply(console, arguments);
        };
        
        // Also suppress warnings that appear immediately
        window.addEventListener('DOMContentLoaded', function() {
            const originalWarn = console.warn;
            console.warn = function(message) {
                if (message && typeof message === 'string' && 
                    (message.includes('cdn.tailwindcss.com should not be used in production') ||
                     message.includes('Components object is deprecated'))) {
                    return; // Suppress these specific warnings
                }
                originalWarn.apply(console, arguments);
            };
        });
    </script><link rel="stylesheet" href="../css/hover-effects.css" /><link rel="stylesheet" href="../css/responsive.css" /><link rel="stylesheet" href="../css/navbar.css" /><link rel="stylesheet" href="../css/cart-styles.css" /><link rel="stylesheet" href="../css/background-animations.css" /><style>
      :root {
        --primary-green: #0ad167;
        --dark-green: #1b5e20;
        --light-green: #e8f5e9;
        --accent-green: #19e619;
        --text-dark: #151612;
      }

      body {
        background: linear-gradient(
          135deg,
          #fdfefd 0%,
          #f8fbf8 30%,
          #f2f7f2 70%,
          #fafcfa 100%
        );
        min-height: 100vh;
      }

      /* Modern Navbar Styles */
      .modern-navbar {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        padding: 0.75rem 0;
      }

      .modern-navbar.scrolled {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(25px);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }

      .modern-navbar.hidden {
        transform: translateY(-100%);
      }

      .navbar-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 2rem;
        gap: 2rem;
      }

      .navbar-brand {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-weight: 700;
        color: #1b5e20;
        text-decoration: none;
      }

      .navbar-logo {
        height: 2.5rem;
        width: auto;
        transition: transform 0.3s ease;
      }

      .navbar-logo:hover {
        transform: scale(1.05);
      }

      .brand-text {
        font-size: 1.25rem;
        font-weight: 800;
        background: linear-gradient(135deg, #1b5e20, #0ad167);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .navbar-links {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        flex: 1;
        justify-content: center;
      }

      .nav-link {
        color: #1b5e20;
        text-decoration: none;
        font-weight: 500;
        font-size: 0.95rem;
        padding: 0.5rem 1rem;
        border-radius: 1.5rem;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        white-space: nowrap;
      }

      .nav-link::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(10, 209, 103, 0.1),
          transparent
        );
        transition: left 0.5s ease;
      }

      .nav-link:hover::before {
        left: 100%;
      }

      .nav-link:hover,
      .nav-link.active {
        color: #0ad167;
        background: rgba(10, 209, 103, 0.1);
        transform: translateY(-1px);
      }

      .navbar-auth {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        flex-shrink: 0;
      }

      .nav-auth-btn {
        display: inline-flex;
        align-items: center;
        padding: 0.5rem 1.25rem;
        background: rgba(10, 209, 103, 0.1);
        border: 1px solid rgba(10, 209, 103, 0.2);
        color: #1b5e20;
        text-decoration: none;
        border-radius: 1.5rem;
        font-weight: 600;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
      }

      .nav-auth-btn:hover {
        background: rgba(10, 209, 103, 0.2);
        border-color: rgba(10, 209, 103, 0.4);
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(10, 209, 103, 0.2);
        color: #0ad167;
      }

      .mobile-menu-toggle {
        display: none;
        flex-direction: column;
        gap: 0.25rem;
        background: none;
        border: none;
        cursor: pointer;
        padding: 0.5rem;
      }

      .hamburger-line {
        width: 1.5rem;
        height: 2px;
        background: #1b5e20;
        border-radius: 1px;
        transition: all 0.3s ease;
      }

      .mobile-menu-toggle.active .hamburger-line:nth-child(1) {
        transform: rotate(45deg) translate(0.35rem, 0.35rem);
      }

      .mobile-menu-toggle.active .hamburger-line:nth-child(2) {
        opacity: 0;
      }

      .mobile-menu-toggle.active .hamburger-line:nth-child(3) {
        transform: rotate(-45deg) translate(0.35rem, -0.35rem);
      }

      @media (max-width: 768px) {
        .navbar-container {
          padding: 0 1rem;
          justify-content: space-between;
        }

        /* Hide desktop navigation links on mobile */
        .navbar-links {
          position: fixed;
          top: 4rem;
          left: 0;
          right: 0;
          background: rgba(255, 255, 255, 0.98);
          backdrop-filter: blur(25px);
          flex-direction: column;
          padding: 2rem 0;
          gap: 1rem;
          transform: translateY(-100%);
          opacity: 0;
          visibility: hidden;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          border-bottom: 1px solid rgba(255, 255, 255, 0.2);
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
          z-index: 40;
        }

        .navbar-links.active {
          transform: translateY(0);
          opacity: 1;
          visibility: visible;
        }

        /* Hide desktop auth buttons on mobile */
        .navbar-auth {
          display: none;
        }

        /* Show mobile menu toggle */
        .mobile-menu-toggle {
          display: flex;
          z-index: 50;
        }

        /* Mobile-only auth icons */
        .mobile-auth-icons {
          display: flex;
          align-items: center;
          gap: 0.75rem;
        }

        .mobile-icon-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 2.5rem;
          height: 2.5rem;
          background: rgba(10, 209, 103, 0.1);
          border: 1px solid rgba(10, 209, 103, 0.2);
          border-radius: 50%;
          color: #1b5e20;
          text-decoration: none;
          transition: all 0.3s ease;
          backdrop-filter: blur(10px);
        }

        .mobile-icon-btn:hover {
          background: rgba(10, 209, 103, 0.2);
          border-color: rgba(10, 209, 103, 0.4);
          transform: scale(1.05);
          color: #0ad167;
        }
      }

      /* Background animations moved to background-animations.css */
      
      /* Print Page Animations */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      
      @keyframes fadeInLeft {
        from {
          opacity: 0;
          transform: translateX(-30px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      
      @keyframes fadeInRight {
        from {
          opacity: 0;
          transform: translateX(30px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      
      @keyframes scaleIn {
        from {
          opacity: 0;
          transform: scale(0.9);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      
      @keyframes slideInDown {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      
      @keyframes pulse {
        0%, 100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }
      
      @keyframes bounce {
        0%, 20%, 53%, 80%, 100% {
          transform: translate3d(0, 0, 0);
        }
        40%, 43% {
          transform: translate3d(0, -8px, 0);
        }
        70% {
          transform: translate3d(0, -4px, 0);
        }
        90% {
          transform: translate3d(0, -2px, 0);
        }
      }
      
      @keyframes shimmer {
        0% {
          background-position: -200px 0;
        }
        100% {
          background-position: calc(200px + 100%) 0;
        }
      }
      
      @keyframes float {
        0%, 100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
      }
      
      /* Animation Classes */
      .animate-fade-in-up {
        animation: fadeInUp 0.6s ease-out;
      }
      
      .animate-fade-in-left {
        animation: fadeInLeft 0.6s ease-out;
      }
      
      .animate-fade-in-right {
        animation: fadeInRight 0.6s ease-out;
      }
      
      .animate-scale-in {
        animation: scaleIn 0.5s ease-out;
      }
      
      .animate-slide-in-down {
        animation: slideInDown 0.5s ease-out;
      }
      
      .animate-pulse {
        animation: pulse 2s infinite;
      }
      
      .animate-bounce {
        animation: bounce 1s infinite;
      }
      
      .animate-float {
        animation: float 3s ease-in-out infinite;
      }
      
      .animate-shimmer {
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
        background-size: 200px 100%;
        animation: shimmer 2s infinite;
      }
      
      /* Staggered Animation Delays */
      .stagger-1 { animation-delay: 0.1s; }
      .stagger-2 { animation-delay: 0.2s; }
      .stagger-3 { animation-delay: 0.3s; }
      .stagger-4 { animation-delay: 0.4s; }
      .stagger-5 { animation-delay: 0.5s; }
      .stagger-6 { animation-delay: 0.6s; }
      
      /* Enhanced Form Styling */
      .form-input {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }
      
      .form-input:focus {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(10, 209, 103, 0.15);
        border-color: #0ad167;
      }
      
      .form-input:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 15px rgba(10, 209, 103, 0.1);
      }
      
      /* Enhanced Button Styling */
      .btn-primary {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }
      
      .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(10, 209, 103, 0.3);
      }
      
      .btn-primary:active {
        transform: translateY(-1px);
      }
      
      .btn-primary::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s ease;
      }
      
      .btn-primary:hover::before {
        left: 100%;
      }
      
      /* Enhanced Card Styling */
      .card {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }
      
      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      }
      
      .card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(10, 209, 103, 0.05), rgba(25, 230, 25, 0.05));
        opacity: 0;
        transition: opacity 0.3s ease;
        pointer-events: none;
      }
      
      .card:hover::before {
        opacity: 1;
      }
      
      /* File Upload Area Enhancements */
      .file-upload-area {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }
      
      .file-upload-area:hover {
        transform: scale(1.02);
        box-shadow: 0 10px 30px rgba(10, 209, 103, 0.2);
      }
      
      .file-upload-area.dragover {
        transform: scale(1.05);
        animation: pulse 0.5s ease-in-out;
      }
      
      /* Radio Button Enhancements */
      input[type="radio"] {
        transition: all 0.3s ease;
      }
      
      input[type="radio"]:checked {
        transform: scale(1.2);
      }
      
      /* Select Enhancements */
      select {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      select:focus {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(10, 209, 103, 0.15);
      }
      
      /* Textarea Enhancements */
      textarea {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        resize: none;
      }
      
      textarea:focus {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(10, 209, 103, 0.15);
      }
      
      /* Loading States */
      .loading {
        position: relative;
        overflow: hidden;
      }
      
      .loading::after {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
        animation: shimmer 1.5s infinite;
      }
      
      /* Success States */
      .success {
        animation: bounce 0.6s ease-in-out;
      }
      
      /* Error States */
      .error {
        animation: shake 0.5s ease-in-out;
      }
      
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-5px); }
        75% { transform: translateX(5px); }
      }
      
      /* Mobile Responsive Animations */
      @media (max-width: 768px) {
        .animate-fade-in-up,
        .animate-fade-in-left,
        .animate-fade-in-right {
          animation-duration: 0.4s;
        }
        
        .card:hover {
          transform: translateY(-2px);
        }
        
        .btn-primary:hover {
          transform: translateY(-2px);
        }
      }
      
      /* Intersection Observer Animation Classes */
      .animate-on-scroll {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      .animate-on-scroll.animated {
        opacity: 1;
        transform: translateY(0);
      }
      
      /* Smooth Page Transitions */
      .page-transition {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      /* Enhanced Navbar Animations */
      .modern-navbar {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      .nav-link {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
      }
      
      .nav-link::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 50%;
        width: 0;
        height: 2px;
        background: linear-gradient(90deg, #0ad167, #19e619);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        transform: translateX(-50%);
      }
      
      .nav-link:hover::after,
      .nav-link.active::after {
        width: 100%;
      }
      
      /* Enhanced Cart Count Animation */
      #cartCount, #mobileCartCount {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      #cartCount.updated, #mobileCartCount.updated {
        animation: bounce 0.6s ease-in-out;
        transform: scale(1.2);
      }
    </style></head><body><div
      class="relative flex min-h-screen flex-col overflow-x-hidden font-[Inter, 'Noto Sans', sans-serif] modern-gradient"
    ><!-- Background Animation Container --><div
        class="particles-container fixed inset-0 pointer-events-none z-0"
        id="particlesContainer"
      ></div><!-- Modern Seamless Navbar --><nav class="modern-navbar fixed top-0 left-0 right-0 z-30"><div class="navbar-container"><!-- Logo/Brand --><div class="navbar-brand"><a href="index.html" class="flex items-center"><img
                src="../assets/fLogo.png"
                alt="NethwinLK"
                class="navbar-logo"
              /></a></div><!-- Navigation Links --><div class="navbar-links" id="navbarLinks"><a href="index.html" class="nav-link">Home</a><a href="print.html" class="nav-link active">Print Services</a><a href="bookshop.html" class="nav-link">Bookshop</a><a href="aboutus.html" class="nav-link">About</a><a href="contactus.html" class="nav-link">Contact</a></div><!-- Desktop Auth Area --><div class="navbar-auth" id="navbarAuth"><a href="cart.html" class="nav-auth-btn cart-container relative"><svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5H17M9 19.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM20.5 19.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"></path>
        </svg>
        <span>Cart</span>
        <span class="cart-count hidden" id="cartCount">0</span></a><a href="search.html" class="nav-auth-btn"><svg
                class="w-4 h-4 mr-2"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              ><path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path></svg>
              Search</a><a href="login.html" class="nav-auth-btn"><svg
                class="w-4 h-4 mr-2"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              ><path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013 3v1"
                ></path></svg>
              Login</a></div><!-- Mobile Auth Icons (hidden on desktop) --><div class="mobile-auth-icons hidden md:hidden"><a href="cart.html" class="mobile-icon-btn mobile-cart-container relative"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5H17M9 19.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM20.5 19.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"></path>
        </svg>
        <span class="mobile-cart-count hidden" id="mobileCartCount">0</span></a><a href="search.html" class="mobile-icon-btn"><svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              ><path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path></svg></a><a href="login.html" class="mobile-icon-btn"><svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              ><path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013 3v1"
                ></path></svg></a></div><!-- Mobile Menu Toggle --><button class="mobile-menu-toggle" id="mobileToggle"><span class="hamburger-line"></span><span class="hamburger-line"></span><span class="hamburger-line"></span></button></div></nav><!-- Navbar Spacer --><div style="height: 4rem"></div><div class="layout-container flex flex-col grow h-full relative z-10"><!-- Form Starts Here --><form
          id="printForm"
          class="px-4 sm:px-6 md:px-8 lg:px-16 xl:px-40 flex justify-center py-5 flex-1 page-transition"
          enctype="multipart/form-data"
        ><div class="flex flex-col max-w-[960px] flex-1 w-full"><div class="flex flex-wrap justify-between gap-3 p-2 sm:p-4 animate-fade-in-down"><p
                class="text-xl sm:text-2xl md:text-3xl lg:text-[32px] font-bold break-words animate-float"
              >
                Print Order Form
              </p></div><!-- Customer Information (only shown when not logged in) --><div id="customerInfoSection" class="animate-fade-in-up stagger-1" style="display: none;"><h2
                class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-slide-in-down"
              >
                Customer Information
              </h2><div
                class="flex max-w-full sm:max-w-[480px] flex-wrap items-end gap-4 px-2 sm:px-4 py-3"
              ><label class="flex flex-col w-full"><p class="font-medium pb-2 text-sm sm:text-base">
                    Full Name *
                  </p><input
                    type="text"
                    name="userName"
                    placeholder="Enter your full name"
                    class="form-input w-full h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                  /></label></div><div
                class="flex max-w-full sm:max-w-[480px] flex-wrap items-end gap-4 px-2 sm:px-4 py-3"
              ><label class="flex flex-col w-full"><p class="font-medium pb-2 text-sm sm:text-base">
                    Email Address *
                  </p><input
                    type="email"
                    name="email"
                    placeholder="Enter your email address"
                    class="form-input w-full h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                  /></label></div><div
                class="flex max-w-full sm:max-w-[480px] flex-wrap items-end gap-4 px-2 sm:px-4 py-3"
              ><label class="flex flex-col w-full"><p class="font-medium pb-2 text-sm sm:text-base">
                    Contact Number *
                  </p><input
                    type="tel"
                    name="contactNumber"
                    placeholder="Enter your contact number"
                    class="form-input w-full h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                  /></label></div></div><!-- Logged in user info display --><div id="loggedInUserInfo" class="animate-fade-in-up stagger-1" style="display: none;"><h2
                class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-slide-in-down"
              >
                Account Information
              </h2><div class="px-2 sm:px-4 py-3"><div class="bg-blue-50 border border-blue-200 rounded-xl p-4 card animate-scale-in"><p class="text-sm font-medium text-gray-700 mb-2">Ordering as:</p><p class="text-lg font-semibold text-blue-600" id="userDisplayName"></p><p class="text-sm text-gray-600" id="userDisplayEmail"></p><p class="text-sm text-gray-600" id="userDisplayPhone"></p></div></div><!-- Hidden fields for logged-in users --><input type="hidden" name="userName" id="hiddenUserName" required><input type="hidden" name="email" id="hiddenEmail" required><input type="hidden" name="contactNumber" id="hiddenContactNumber" required></div><!-- Login prompt for non-logged in users --><div id="loginPrompt" class="animate-fade-in-up stagger-1" style="display: none;"><div class="px-2 sm:px-4 py-3"><div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4 card animate-scale-in"><div class="flex items-center justify-between"><div><p class="text-sm font-medium text-yellow-800 mb-1">
                        Have an account?
                      </p><p class="text-xs text-yellow-600">
                        Login to skip filling customer information
                      </p></div><a 
                      href="login.html" 
                      class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"
                    >
                      Login</a></div></div></div></div><!-- Document Upload --><h2
              class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-fade-in-up stagger-2"
            >
              Document Upload
            </h2><div class="flex flex-col p-4 sm:p-6 animate-fade-in-up stagger-3"><label
                for="document"
                class="file-upload-area flex flex-col items-center justify-center gap-4 sm:gap-6 rounded-xl border-2 border-dashed border-gray-300 hover:border-green-500 transition-colors duration-300 cursor-pointer bg-gray-50 hover:bg-green-50 px-6 py-10 sm:py-14 text-center"
              ><svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-12 w-12 text-green-500"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                  stroke-width="2"
                ><path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M4 16v4h16v-4M12 12v8m0-8l4 4m-4-4l-4 4m0-8h.01M20 8V6a2 2 0 00-2-2H6a2 2 0 00-2 2v2"
                  /></svg><div><p class="text-base sm:text-lg font-semibold text-gray-700">
                    Drag & Drop your document here
                  </p><p class="text-xs sm:text-sm text-gray-500 mt-1">
                    or click to browse (PDF, DOC, DOCX, TXT, JPG, JPEG, PNG, GIF)
                  </p><p class="text-xs text-red-500 mt-1">
                    Maximum file size: 10MB
                  </p></div><input
                  type="file"
                  id="document"
                  name="document"
                  accept=".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.gif"
                  required
                  class="hidden"
                /></label></div><!-- Document Preview --><h2
              class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-fade-in-up stagger-4"
            >
              Document Preview
            </h2><div
              id="previewContainer"
              class="p-2 sm:p-4 animate-fade-in-up stagger-5"
            ><div id="noFileMessage" class="text-center text-gray-500 py-8"><svg class="mx-auto h-12 w-12 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg><p>No document selected</p></div><div id="filePreview" class="hidden"><div class="bg-white border border-gray-200 rounded-lg p-4"><div class="flex items-center justify-between mb-2"><h3 class="font-medium text-gray-900" id="fileName"></h3><div class="flex gap-2"><button 
                      id="viewFullscreen" 
                      class="text-blue-500 hover:text-blue-700 text-sm font-medium hidden"
                    >
                      <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path></svg>Full Screen
                    </button><button 
                      id="removeFile" 
                      class="text-red-500 hover:text-red-700 text-sm font-medium"
                    >
                      <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>Remove
                    </button></div></div><div id="filePreviewContent" class="mt-2"></div><div id="fileDetails" class="mt-3 p-3 bg-gray-50 rounded-lg text-xs text-gray-600 hidden"><div class="grid grid-cols-2 gap-2"><div><span class="font-medium">Size:</span> <span id="fileSizeText"></span></div><div><span class="font-medium">Type:</span> <span id="fileTypeText"></span></div><div id="imageDimensions" class="hidden"><span class="font-medium">Dimensions:</span> <span id="dimensionsText"></span></div><div id="imageResolution" class="hidden"><span class="font-medium">Resolution:</span> <span id="resolutionText"></span></div></div></div></div></div></div><!-- Print Options --><h2
              class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-fade-in-up stagger-6"
            >
              Print Specifications
            </h2><div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3 animate-fade-in-left stagger-1"
            ><label class="flex flex-col w-full"><p class="pb-2 font-medium text-sm sm:text-base">Paper Size *</p><select
                  name="paperSize"
                  id="paperSize"
                  required
                  class="form-input h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                ><option value="">Select Paper Size</option><option value="A6">A6</option><option value="A5">A5</option><option value="A4">A4</option><option value="A3">A3</option><option value="A2">A2</option><option value="A1">A1</option></select></label></div><div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3 animate-fade-in-right stagger-2"
            ><label class="flex flex-col w-full"><p class="pb-2 font-medium text-sm sm:text-base">Color Option *</p><select
                  name="colorOption"
                  id="colorOption"
                  required
                  class="form-input h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                ><option value="">Select Color Option</option><option value="normal_color">Normal Color</option><option value="laser_color">Laser Color</option><option value="bw_single">Black & White (Single-sided)</option><option value="bw_double">Black & White (Double-sided)</option></select></label></div><div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3 animate-fade-in-left stagger-3"
            ><label class="flex flex-col w-full"><p class="pb-2 font-medium text-sm sm:text-base">Binding *</p><select
                  name="binding"
                  id="binding"
                  required
                  class="form-input h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                ><option value="">Select Binding</option><option value="None">None</option><option value="Spiral Binding">Spiral Binding</option><option value="Thermal Binding">Thermal Binding</option><option value="Hardcover Binding">Hardcover Binding</option><option value="Saddle Stitching">Saddle Stitching</option></select></label></div><div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3 animate-fade-in-right stagger-4"
            ><label class="flex flex-col w-full"><p class="pb-2 font-medium text-sm sm:text-base">
                  Number of Copies *
                </p><input
                  type="number"
                  name="copies"
                  id="copies"
                  min="1"
                  value="1"
                  required
                  class="form-input h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                /></label></div><div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3 animate-fade-in-left stagger-5"
            ><label class="flex flex-col w-full"><p class="pb-2 font-medium text-sm sm:text-base">Finishing *</p><select
                  name="finishing"
                  id="finishing"
                  required
                  class="form-input h-12 sm:h-14 p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base"
                ><option value="">Select Finishing</option><option value="None">None</option><option value="Lamination (Gloss)">Lamination (Gloss)</option><option value="Lamination (Matte)">Lamination (Matte)</option><option value="Foil Stamping">Foil Stamping</option><option value="Embossing/Debossing">Embossing/Debossing</option><option value="Die-Cutting">Die-Cutting</option><option value="custom">Custom (Specify in notes)</option></select></label></div><div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3 animate-fade-in-right stagger-6"
              id="additionalNotesContainer"
              style="display: none;"
            ><label class="flex flex-col w-full"><p class="pb-2 font-medium text-sm sm:text-base">Additional Notes *</p><textarea
                  name="additionalNotes"
                  placeholder="Please describe your custom finishing requirements"
                  rows="3"
                  class="form-input w-full p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base resize-none"
                ></textarea></label></div>

            <!-- Dynamic Pricing Calculator -->
            <div class="px-2 sm:px-4 py-4 animate-fade-in-up stagger-7">
              <div class="bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-xl p-4 sm:p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                  <svg class="w-5 h-5 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                  </svg>
                  Price Calculator
                </h3>
                
                <div id="priceCalculator" class="space-y-3">
                  <div class="text-center text-gray-500 py-8">
                    <svg class="mx-auto h-12 w-12 text-gray-400 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                    </svg>
                    <p class="text-sm">Select print options to see pricing</p>
                  </div>
                </div>
                
                <div id="priceBreakdown" class="hidden space-y-2 text-sm">
                  <div class="flex justify-between items-center py-1">
                    <span class="text-gray-600">Paper Size & Color:</span>
                    <span class="font-medium" id="basePrice">Select paper size</span>
                  </div>
                  <div class="flex justify-between items-center py-1">
                    <span class="text-gray-600">Color Upgrade:</span>
                    <span class="font-medium" id="colorUpgrade">Select color option</span>
                  </div>
                  <div class="flex justify-between items-center py-1">
                    <span class="text-gray-600">Binding Cost:</span>
                    <span class="font-medium" id="bindingCost">+Rs. 0 (No binding)</span>
                  </div>
                  <div class="flex justify-between items-center py-1">
                    <span class="text-gray-600">Finishing Cost:</span>
                    <span class="font-medium" id="finishingCost">+Rs. 0 (No finishing)</span>
                  </div>
                  <div class="flex justify-between items-center py-1 border-t border-gray-300 pt-2">
                    <span class="text-gray-800 font-semibold">Total Cost:</span>
                    <span class="text-green-600 font-bold text-lg" id="totalPrice">Select options to see price</span>
                  </div>
                  <div id="partialWarning" class="hidden text-xs text-amber-600 bg-amber-50 p-2 rounded mt-2">
                    <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                    </svg>
                    Partial pricing - complete all selections for final price
                  </div>
                </div>
              </div>
            </div>

            <!-- Delivery Options --><h2
              class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-fade-in-up stagger-1"
            >
              Delivery Options
            </h2>            <div class="flex flex-col gap-4 p-2 sm:p-4 animate-fade-in-up stagger-2">
              <!-- Home Delivery Option -->
              <label class="delivery-option group cursor-pointer flex items-center gap-4 p-3 rounded-lg transition-colors">
                <input
                  type="radio"
                  name="deliveryMethod"
                  value="Home Delivery"
                  required
                  class="h-5 w-5 text-blue-600 focus:ring-blue-500"
                />
                <div class="delivery-icon w-10 h-10 bg-green-100 rounded-full flex items-center justify-center group-hover:bg-green-200 transition-colors">
                  <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                  </svg>
                </div>
                <div class="flex-1">
                  <h4 class="font-semibold text-gray-800 text-base">Home Delivery</h4>
                  <p class="text-sm text-gray-600">
                    <span class="font-medium text-green-600">LKR <span id="printDeliveryPrice">0.00</span></span> - Within <span id="printDeliveryRadius">10</span>km
                  </p>
                </div>
              </label>
              
              <!-- Store Pickup Option -->
              <label class="delivery-option group cursor-pointer flex items-center gap-4 p-3 rounded-lg transition-colors">
                <input
                  type="radio"
                  name="deliveryMethod"
                  value="Pickup"
                  required
                  class="h-5 w-5 text-blue-600 focus:ring-blue-500"
                />
                <div class="delivery-icon w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center group-hover:bg-blue-200 transition-colors">
                  <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                  </svg>
                </div>
                <div class="flex-1">
                  <h4 class="font-semibold text-gray-800 text-base">Store Pickup</h4>
                  <p class="text-sm text-gray-600">
                    <span class="font-medium text-green-600">Free</span> - Collect from our location
                  </p>
                </div>
              </label>
            </div>            <div
              class="flex max-w-full sm:max-w-[480px] flex-wrap gap-4 px-2 sm:px-4 py-3"
            >
              <label class="flex flex-col w-full" id="deliveryAddressLabel">
                <div class="flex items-center justify-between pb-2">
                  <p class="font-medium text-sm sm:text-base">Delivery Address *</p>
                  <button 
                    type="button" 
                    id="useSavedAddressBtn" 
                    class="text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors"
                    onclick="useSavedAddress()"
                  >
                    📍 Use Saved Address
                  </button>
                </div>
                <textarea
                  name="deliveryAddress"
                  id="deliveryAddress"
                  placeholder="Enter your delivery address or click 'Use Saved Address' to auto-fill"
                  rows="3"
                  required
                  class="form-input w-full p-3 sm:p-[15px] rounded-xl border border-[#dbdfe6] text-sm sm:text-base resize-none"
                ></textarea>
                <div id="savedAddressNotification" class="hidden mt-2 p-2 bg-green-50 border border-green-200 rounded-lg">
                  <p class="text-sm text-green-700">✅ Address loaded from your profile!</p>
                </div>
              </label>
            </div>
            
            <!-- Store Pickup Notification -->
            <div id="storePickupNotification" class="hidden px-2 sm:px-4 py-3 transition-all duration-300 ease-in-out">
              <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 animate-fade-in-up">
                <div class="flex items-start">
                  <svg class="w-5 h-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  <div>
                    <h3 class="text-sm font-medium text-blue-800 mb-1">Store Pickup Selected</h3>
                    <p class="text-sm text-blue-700">
                      We will notify you when your print job is ready. You can collect it from our location at your convenience.
                    </p>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Payment Options -->
            <h2 class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-fade-in-up stagger-3">
              Payment Method
            </h2>
            
            <style>
              /* Clean, minimal styling for delivery and payment options */
              .delivery-option, .payment-option {
                transition: all 0.2s ease;
                border-radius: 8px;
                position: relative;
              }
              
              /* Subtle hover effect - no background box */
              .delivery-option:hover, .payment-option:hover {
                background-color: rgba(249, 250, 251, 0.5);
                transform: translateX(4px);
              }
              
              /* Selected state - clean and minimal */
              .delivery-option input[type="radio"]:checked + .delivery-icon,
              .payment-option input[type="radio"]:checked + .payment-icon {
                background-color: #3b82f6;
                color: white;
                transform: scale(1.05);
                box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
              }
              
              .delivery-option input[type="radio"]:checked + .delivery-icon svg,
              .payment-option input[type="radio"]:checked + .payment-icon svg {
                color: white;
              }
              
              /* Focus states */
              .delivery-option input[type="radio"]:focus,
              .payment-option input[type="radio"]:focus {
                outline: none;
                box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
                border-radius: 50%;
              }
              
              /* Icon styling */
              .delivery-icon, .payment-icon {
                transition: all 0.2s ease;
                border: 2px solid transparent;
              }
              
              .delivery-option:hover .delivery-icon,
              .payment-option:hover .payment-icon {
                transform: scale(1.05);
                border-color: rgba(59, 130, 246, 0.2);
              }
              
              /* Text styling */
              .delivery-option h4, .payment-option h4 {
                transition: color 0.2s ease;
                font-weight: 600;
              }
              
              .delivery-option:hover h4,
              .payment-option:hover h4 {
                color: #1f2937;
              }
              
              .delivery-option p, .payment-option p {
                transition: color 0.2s ease;
                font-size: 0.875rem;
              }
              
              .delivery-option:hover p,
              .payment-option:hover p {
                color: #4b5563;
              }
              
              /* Radio button styling */
              .delivery-option input[type="radio"],
              .payment-option input[type="radio"] {
                transition: all 0.2s ease;
              }
              
              .delivery-option input[type="radio"]:checked,
              .payment-option input[type="radio"]:checked {
                transform: scale(1.1);
              }
              
              /* Subtle selection indicator */
              .delivery-option:has(input[type="radio"]:checked),
              .payment-option:has(input[type="radio"]:checked) {
                background-color: rgba(239, 246, 255, 0.3);
                border-left: 3px solid #3b82f6;
                padding-left: 8px;
              }
            </style>
            <div id="paymentOptions" class="px-2 sm:px-4 py-3 animate-fade-in-up stagger-4">
              <!-- Home Delivery Payment Options -->
              <div id="homeDeliveryPayment" class="space-y-3">
                <label class="payment-option group cursor-pointer flex items-center gap-4 p-3 rounded-lg transition-colors">
                  <input type="radio" name="paymentMethod" value="Cash on Delivery" required class="h-5 w-5 text-green-600 focus:ring-green-500" checked>
                  <div class="payment-icon w-10 h-10 bg-green-100 rounded-full flex items-center justify-center group-hover:bg-green-200 transition-colors">
                    <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                    </svg>
                  </div>
                  <div class="flex-1">
                    <h4 class="font-semibold text-gray-800 text-base">Cash on Delivery</h4>
                    <p class="text-sm text-gray-600">Pay when your order is delivered</p>
                  </div>
                </label>
              </div>
              
              <!-- Store Pickup Payment Options -->
              <div id="storePickupPayment" class="hidden space-y-3">
                <label class="payment-option group cursor-pointer flex items-center gap-4 p-3 rounded-lg transition-colors">
                  <input type="radio" name="paymentMethod" value="Cash on Delivery" class="h-5 w-5 text-green-600 focus:ring-green-500">
                  <div class="payment-icon w-10 h-10 bg-green-100 rounded-full flex items-center justify-center group-hover:bg-green-200 transition-colors">
                    <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                    </svg>
                  </div>
                  <div class="flex-1">
                    <h4 class="font-semibold text-gray-800 text-base">Cash on Delivery</h4>
                    <p class="text-sm text-gray-600">Pay when you collect from store</p>
                  </div>
                </label>
                
                <label class="payment-option group cursor-pointer flex items-center gap-4 p-3 rounded-lg transition-colors">
                  <input type="radio" name="paymentMethod" value="Card Payment" class="h-5 w-5 text-blue-600 focus:ring-blue-500">
                  <div class="payment-icon w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center group-hover:bg-blue-200 transition-colors">
                    <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                    </svg>
                  </div>
                  <div class="flex-1">
                    <h4 class="font-semibold text-gray-800 text-base">Card Payment</h4>
                    <p class="text-sm text-gray-600">Pay securely with card at store</p>
                  </div>
                </label>
              </div>
            </div>
            
            <!-- Pricing Info -->
            <h2 class="text-lg sm:text-xl md:text-[22px] font-bold px-2 sm:px-4 pb-3 pt-5 animate-fade-in-up stagger-3">
              Pricing
            </h2><div class="px-2 sm:px-4 py-3 animate-fade-in-up stagger-4"><div class="bg-green-50 border border-green-200 rounded-xl p-4 card animate-pulse"><p class="text-sm sm:text-base font-medium text-gray-700 mb-2">
                  Estimated Price:
                </p><p class="text-2xl sm:text-3xl font-bold text-green-600" id="estimatedPrice">
                  Rs. 0
                </p><p class="text-xs text-gray-500 mt-1">
                  * Final price may vary based on actual requirements
                </p></div></div><!-- Action Buttons --><div
              class="flex flex-col sm:flex-row justify-between gap-3 px-2 sm:px-4 py-3 animate-fade-in-up stagger-5"
            ><div class="flex flex-col sm:flex-row gap-3 w-full sm:w-auto"><a href="index.html" class="btn-primary"> Back to Home</a></div><div class="flex flex-col sm:flex-row gap-3 w-full sm:w-auto"><button type="button" id="submitPrintOrder" class="btn-primary w-full sm:w-auto">
                  Submit Print Order
                </button></div></div></div></form></div></div><script>
      // Pricing data (matches backend)
      const pricingData = {
        paperSizes: [
          { size: "A6", normal_color: 20, laser_color: 65, bw_single: 5, bw_double: 5 },
          { size: "A5", normal_color: 40, laser_color: 125, bw_single: 5, bw_double: 10 },
          { size: "A4", normal_color: 75, laser_color: 250, bw_single: 5, bw_double: 10 },
          { size: "A3", normal_color: 150, laser_color: 500, bw_single: 10, bw_double: 15 },
          { size: "A2", normal_color: 300, laser_color: 1000, bw_single: 15, bw_double: 30 },
          { size: "A1", normal_color: 600, laser_color: 2000, bw_single: 30, bw_double: 65 }
        ],
        binding: [
          { type: "Spiral Binding", price: 50 },
          { type: "Thermal Binding", price: 150 },
          { type: "Hardcover Binding", price: 500 },
          { type: "Saddle Stitching", price: 30 }
        ],
        finishing: [
          { type: "Lamination (Gloss)", price: 50 },
          { type: "Lamination (Matte)", price: 50 },
          { type: "Foil Stamping", price: 100 },
          { type: "Embossing/Debossing", price: 150 },
          { type: "Die-Cutting", price: 200 }
        ],
        delivery: [
          { type: "Home Delivery", price: 0 }, // Will be updated dynamically
          { type: "Pickup", price: 0 }
        ]
      };

      // Calculate price based on selections (legacy function - now handled by pricing calculator)
      function calculatePrice() {
        // This function is now handled by the pricing calculator
        // The pricing calculator will update the estimated price automatically
          return 0;
      }

      // Check authentication and setup form
      async function setupFormForUser() {
        const token = localStorage.getItem('authToken');
        const customerInfoSection = document.getElementById('customerInfoSection');
        const loggedInUserInfo = document.getElementById('loggedInUserInfo');
        const loginPrompt = document.getElementById('loginPrompt');
        
        if (token) {
          try {
            // Decode token to get user info
            const payload = JSON.parse(atob(token.split('.')[1]));
            const userId = payload.sub;
            
            // Fetch user details from API
            const response = await fetch('/api/me', {
              headers: {
                'Authorization': `Bearer ${token}`
              }
            });
            
            if (response.ok) {
              const data = await response.json();
              const user = data.user;
              
              // Debug: Log user data
              console.log('User data received:', user);
              console.log('Available user fields:', Object.keys(user));
              console.log('Full user object:', JSON.stringify(user, null, 2));
              
              // Hide customer info section and login prompt, show logged in user info
              customerInfoSection.style.display = 'none';
              loginPrompt.style.display = 'none';
              loggedInUserInfo.style.display = 'block';
              
              // Get contact number from user data - check all possible field names
              const contactNumber = user.phoneNumber || user.phone || user.contactNumber || user.mobile || '';
              console.log('Contact number found:', contactNumber);
              console.log('phoneNumber:', user.phoneNumber);
              console.log('phone:', user.phone);
              console.log('contactNumber:', user.contactNumber);
              
              // Populate user display with complete profile information
              document.getElementById('userDisplayName').textContent = user.fullName || 'User';
              document.getElementById('userDisplayEmail').textContent = user.email || '';
              document.getElementById('userDisplayPhone').textContent = contactNumber || user.phoneNumber || 'Not provided';
              
              // Show additional user details if available
              const userDetails = document.getElementById('userDisplayPhone');
              if (user.address) {
                userDetails.innerHTML += `<br><span class="text-sm text-gray-600">Address: ${user.address}</span>`;
              }
              if (user.city) {
                userDetails.innerHTML += `<br><span class="text-sm text-gray-600">City: ${user.city}</span>`;
              }
              
              // Pre-populate hidden form fields with user data
              document.getElementById('hiddenUserName').value = user.fullName || '';
              document.getElementById('hiddenEmail').value = user.email || '';
              document.getElementById('hiddenContactNumber').value = contactNumber;
              
              // For logged-in users, we don't need to show customer info section
              // They can only change delivery information
              // All user details are automatically taken from the database
              
              // If contact number is still empty, show customer info section as fallback
              if (!contactNumber) {
                console.warn('User does not have contact number in profile, showing customer info section');
                document.getElementById('customerInfoSection').style.display = 'block';
                document.getElementById('loggedInUserInfo').style.display = 'none';
                // Make contact number required
                document.querySelector('input[name="contactNumber"]').required = true;
              }
              
              // Remove required attribute from visible fields since we're using hidden ones
              document.querySelector('input[name="userName"]').required = false;
              document.querySelector('input[name="email"]').required = false;
              document.querySelector('input[name="contactNumber"]').required = false;
              
            } else {
              // Token invalid, show customer info section and login prompt
              customerInfoSection.style.display = 'block';
              loggedInUserInfo.style.display = 'none';
              loginPrompt.style.display = 'block';
              
              // Make sure form fields are required for non-logged-in users
              document.querySelector('input[name="userName"]').required = true;
              document.querySelector('input[name="email"]').required = true;
              document.querySelector('input[name="contactNumber"]').required = true;
            }
          } catch (error) {
            console.warn('Could not fetch user data:', error);
            // Show customer info section and login prompt as fallback
            customerInfoSection.style.display = 'block';
            loggedInUserInfo.style.display = 'none';
            loginPrompt.style.display = 'block';
            
            // Make sure form fields are required for non-logged-in users
            document.querySelector('input[name="userName"]').required = true;
            document.querySelector('input[name="email"]').required = true;
            document.querySelector('input[name="contactNumber"]').required = true;
          }
        } else {
          // No token, show customer info section and login prompt
          customerInfoSection.style.display = 'block';
          loggedInUserInfo.style.display = 'none';
          loginPrompt.style.display = 'block';
          
          // Make sure form fields are required for non-logged-in users
          document.querySelector('input[name="userName"]').required = true;
          document.querySelector('input[name="email"]').required = true;
          document.querySelector('input[name="contactNumber"]').required = true;
        }
      }

      // Scroll-triggered animations
      function initScrollAnimations() {
        const observerOptions = {
          threshold: 0.1,
          rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('animated');
            }
          });
        }, observerOptions);

        // Observe all elements with animate-on-scroll class
        document.querySelectorAll('.animate-on-scroll').forEach(el => {
          observer.observe(el);
        });
      }

      // Enhanced form interactions
      function initFormAnimations() {
        // Add loading states to form inputs
        const formInputs = document.querySelectorAll('.form-input');
        formInputs.forEach(input => {
          input.addEventListener('focus', function() {
            this.parentElement.classList.add('animate-scale-in');
          });
          
          input.addEventListener('blur', function() {
            this.parentElement.classList.remove('animate-scale-in');
          });
        });

        // Add success/error animations to buttons
        const buttons = document.querySelectorAll('.btn-primary');
        buttons.forEach(button => {
          button.addEventListener('click', function() {
            this.classList.add('animate-bounce');
            setTimeout(() => {
              this.classList.remove('animate-bounce');
            }, 600);
          });
        });

        // Add hover effects to cards
        const cards = document.querySelectorAll('.card');
        cards.forEach(card => {
          card.addEventListener('mouseenter', function() {
            this.classList.add('animate-float');
          });
          
          card.addEventListener('mouseleave', function() {
            this.classList.remove('animate-float');
          });
        });
      }

      // Enhanced file upload animations
      function initFileUploadAnimations() {
        const fileInput = document.getElementById('document');
        const dropZone = fileInput.parentElement;

        // Add dragover animation
        dropZone.addEventListener('dragover', function() {
          this.classList.add('dragover', 'animate-pulse');
        });

        dropZone.addEventListener('dragleave', function() {
          this.classList.remove('dragover', 'animate-pulse');
        });

        dropZone.addEventListener('drop', function() {
          this.classList.remove('dragover', 'animate-pulse');
          this.classList.add('success');
          setTimeout(() => {
            this.classList.remove('success');
          }, 600);
        });

        // File selection animation
        fileInput.addEventListener('change', function() {
          if (this.files.length > 0) {
            dropZone.classList.add('success');
            setTimeout(() => {
              dropZone.classList.remove('success');
            }, 600);
          }
        });
      }

      // Price calculation with animation
      function animatePriceChange() {
        const priceElement = document.getElementById('estimatedPrice');
        if (priceElement) {
          priceElement.classList.add('animate-bounce');
          setTimeout(() => {
            priceElement.classList.remove('animate-bounce');
          }, 600);
        }
      }

      // Enhanced cart count animation
      function animateCartUpdate() {
        const cartCount = document.getElementById('cartCount');
        const mobileCartCount = document.getElementById('mobileCartCount');
        
        if (cartCount) {
          cartCount.classList.add('updated');
          setTimeout(() => {
            cartCount.classList.remove('updated');
          }, 600);
        }
        
        if (mobileCartCount) {
          mobileCartCount.classList.add('updated');
          setTimeout(() => {
            mobileCartCount.classList.remove('updated');
          }, 600);
        }
      }

      // Add event listeners for price calculation
      document.addEventListener('DOMContentLoaded', function() {
        // Initialize animations
        initScrollAnimations();
        initFormAnimations();
        initFileUploadAnimations();
        
        // Setup form based on authentication state
        setupFormForUser();
        
        const priceInputs = [
          'select[name="paperSize"]',
          'select[name="colorOption"]',
          'input[name="copies"]',
          'select[name="binding"]',
          'select[name="finishing"]',
          'input[name="deliveryMethod"]'
        ];

        priceInputs.forEach(selector => {
          const elements = document.querySelectorAll(selector);
          elements.forEach(element => {
            element.addEventListener('change', calculatePrice);
            element.addEventListener('input', calculatePrice);
          });
        });

        // Show/hide additional notes based on finishing selection
        const finishingSelect = document.querySelector('select[name="finishing"]');
        const additionalNotesContainer = document.getElementById('additionalNotesContainer');
        
        finishingSelect.addEventListener('change', function() {
          if (this.value === 'custom') {
            additionalNotesContainer.style.display = 'block';
            additionalNotesContainer.querySelector('textarea').required = true;
          } else {
            additionalNotesContainer.style.display = 'none';
            additionalNotesContainer.querySelector('textarea').required = false;
          }
        });
      });

      // File upload handling
      const fileInput = document.getElementById('document');
      const dropZone = fileInput.parentElement;

      // Prevent default browser behavior for the whole page
      ["dragenter", "dragover", "dragleave", "drop"].forEach((eventName) => {
        document.addEventListener(eventName, (e) => e.preventDefault());
      });

      // Add visual feedback when dragging
      document.addEventListener("dragover", () =>
        dropZone.classList.add("border-green-500", "bg-green-50")
      );
      document.addEventListener("dragleave", () =>
        dropZone.classList.remove("border-green-500", "bg-green-50")
      );

      // Handle dropped files
      document.addEventListener("drop", (e) => {
        const droppedFiles = Array.from(e.dataTransfer.files);
        if (droppedFiles.length > 0) {
          fileInput.files = droppedFiles[0]; // Only take first file
        }
        dropZone.classList.remove("border-green-500", "bg-green-50");
      });

      // File input change
      fileInput.addEventListener('change', function() {
        if (this.files.length > 0) {
          showFilePreview(this.files[0]);
        } else {
          hideFilePreview();
        }
      });

      // Show file preview
      function showFilePreview(file) {
        const noFileMessage = document.getElementById('noFileMessage');
        const filePreview = document.getElementById('filePreview');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        const filePreviewContent = document.getElementById('filePreviewContent');

        // Hide no file message and show preview
        if (noFileMessage) noFileMessage.style.display = 'none';
        if (filePreview) filePreview.classList.remove('hidden');

        // Set file name and size
        if (fileName) fileName.textContent = file.name;
        if (fileSize) fileSize.textContent = `Size: ${(file.size / 1024 / 1024).toFixed(2)} MB`;
        
        // Show file details
        const fileDetails = document.getElementById('fileDetails');
        const fileSizeText = document.getElementById('fileSizeText');
        const fileTypeText = document.getElementById('fileTypeText');
        
        if (fileDetails) fileDetails.classList.remove('hidden');
        if (fileSizeText) fileSizeText.textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB`;
        if (fileTypeText) fileTypeText.textContent = file.type;

        // Create preview based on file type
        if (filePreviewContent) filePreviewContent.innerHTML = '';
        
        if (file.type.startsWith('image/')) {
          const img = document.createElement('img');
          img.src = URL.createObjectURL(file);
          img.className = 'w-full h-48 object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity';
          img.alt = file.name;
          img.onclick = () => openFullscreenModal(file);
          if (filePreviewContent) filePreviewContent.appendChild(img);
          
          // Show fullscreen button for images
          const viewFullscreenBtn = document.getElementById('viewFullscreen');
          if (viewFullscreenBtn) {
            viewFullscreenBtn.classList.remove('hidden');
          }
          
          // Get image dimensions
          img.onload = function() {
            const fileDetails = document.getElementById('fileDetails');
            const dimensionsText = document.getElementById('dimensionsText');
            const resolutionText = document.getElementById('resolutionText');
            const imageDimensions = document.getElementById('imageDimensions');
            const imageResolution = document.getElementById('imageResolution');
            
            if (fileDetails) fileDetails.classList.remove('hidden');
            
            const dimensions = `${this.naturalWidth} × ${this.naturalHeight}`;
            const resolution = `${Math.round(this.naturalWidth * this.naturalHeight / 1000000 * 100) / 100} MP`;
            
            if (dimensionsText) dimensionsText.textContent = dimensions;
            if (resolutionText) resolutionText.textContent = resolution;
            if (imageDimensions) imageDimensions.classList.remove('hidden');
            if (imageResolution) imageResolution.classList.remove('hidden');
          };
        } else if (file.type === 'application/pdf') {
          // Create PDF preview container
          const pdfPreview = document.createElement('div');
          pdfPreview.className = 'w-full h-48 bg-gray-100 rounded-lg border-2 border-dashed border-gray-300 flex flex-col items-center justify-center cursor-pointer hover:bg-gray-50 transition-colors';
          pdfPreview.innerHTML = `
            <div class="text-center">
              <svg class="mx-auto h-12 w-12 text-red-500 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
              </svg>
              <p class="text-red-600 font-medium text-sm mb-2">PDF Document</p>
              <p class="text-gray-500 text-xs">Click to view in new tab</p>
            </div>
          `;
          
          // Add click handler to open PDF in new tab
          pdfPreview.onclick = () => {
            const pdfUrl = URL.createObjectURL(file);
            window.open(pdfUrl, '_blank');
          };
          
          if (filePreviewContent) filePreviewContent.appendChild(pdfPreview);
          
          // Show fullscreen button for PDFs
          const viewFullscreenBtn = document.getElementById('viewFullscreen');
          if (viewFullscreenBtn) {
            viewFullscreenBtn.classList.remove('hidden');
            viewFullscreenBtn.onclick = () => openPDFFullscreen(file);
          }
        } else if (file.type.includes('word') || file.type.includes('document')) {
          // Create DOCX preview container
          const docPreview = document.createElement('div');
          docPreview.className = 'w-full h-48 bg-blue-50 rounded-lg border-2 border-dashed border-blue-300 flex flex-col items-center justify-center cursor-pointer hover:bg-blue-100 transition-colors';
          docPreview.innerHTML = `
            <div class="text-center">
              <svg class="mx-auto h-12 w-12 text-blue-500 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              <p class="text-blue-600 font-medium text-sm mb-2">Word Document</p>
              <p class="text-gray-500 text-xs">Click to download</p>
            </div>
          `;
          
          // Add click handler to download DOCX
          docPreview.onclick = () => {
            const docUrl = URL.createObjectURL(file);
            const a = document.createElement('a');
            a.href = docUrl;
            a.download = file.name;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(docUrl);
          };
          
          if (filePreviewContent) filePreviewContent.appendChild(docPreview);
          
          // Show fullscreen button for DOCX
          const viewFullscreenBtn = document.getElementById('viewFullscreen');
          if (viewFullscreenBtn) {
            viewFullscreenBtn.classList.remove('hidden');
            viewFullscreenBtn.onclick = () => openDOCXFullscreen(file);
          }
        } else {
          // Create generic file preview container
          const genericPreview = document.createElement('div');
          genericPreview.className = 'w-full h-48 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300 flex flex-col items-center justify-center cursor-pointer hover:bg-gray-100 transition-colors';
          genericPreview.innerHTML = `
            <div class="text-center">
              <svg class="mx-auto h-12 w-12 text-gray-500 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              <p class="text-gray-600 font-medium text-sm mb-2">${file.type || 'Unknown File'}</p>
              <p class="text-gray-500 text-xs">Click to download</p>
            </div>
          `;
          
          // Add click handler to download file
          genericPreview.onclick = () => {
            const fileUrl = URL.createObjectURL(file);
            const a = document.createElement('a');
            a.href = fileUrl;
            a.download = file.name;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(fileUrl);
          };
          
          if (filePreviewContent) filePreviewContent.appendChild(genericPreview);
        }

        // Add remove file functionality
        const removeFileBtn = document.getElementById('removeFile');
        if (removeFileBtn) {
          removeFileBtn.addEventListener('click', function() {
            fileInput.value = '';
            hideFilePreview();
          });
        }
      }

      // Hide file preview
      function hideFilePreview() {
        const noFileMessage = document.getElementById('noFileMessage');
        const filePreview = document.getElementById('filePreview');
        const fileDetails = document.getElementById('fileDetails');
        const viewFullscreenBtn = document.getElementById('viewFullscreen');
        const imageDimensions = document.getElementById('imageDimensions');
        const imageResolution = document.getElementById('imageResolution');
        const fileInput = document.getElementById('document');
        
        noFileMessage.style.display = 'block';
        filePreview.classList.add('hidden');
        
        // Reset file details
        if (fileDetails) fileDetails.classList.add('hidden');
        if (viewFullscreenBtn) viewFullscreenBtn.classList.add('hidden');
        if (imageDimensions) imageDimensions.classList.add('hidden');
        if (imageResolution) imageResolution.classList.add('hidden');
        
        // Clear file input
        if (fileInput) fileInput.value = '';
      }
    </script><script>
      // Update cart count function
      function updateCartCount() {
        try {
          const cart = JSON.parse(localStorage.getItem("nethwin_cart") || "[]");
          const totalItems = cart.reduce((sum, item) => sum + (item.qty || item.quantity || 1), 0);
          
          const cartCount = document.getElementById('cartCount');
          const mobileCartCount = document.getElementById('mobileCartCount');
          
          if (totalItems > 0) {
            if (cartCount) {
              cartCount.textContent = totalItems;
              cartCount.classList.remove('hidden');
              animateCartUpdate();
            }
            if (mobileCartCount) {
              mobileCartCount.textContent = totalItems;
              mobileCartCount.classList.remove('hidden');
              animateCartUpdate();
            }
          } else {
            if (cartCount) {
              cartCount.classList.add('hidden');
            }
            if (mobileCartCount) {
              mobileCartCount.classList.add('hidden');
            }
          }
        } catch (e) {
          console.warn("Could not update cart count:", e);
        }
      }

      // Navbar interactions
      document.addEventListener("DOMContentLoaded", () => {
        const mobileToggle = document.getElementById("mobileToggle");
        const navbarLinks = document.getElementById("navbarLinks");
        const navbar = document.querySelector(".modern-navbar");
        
        // Update cart count on page load
        updateCartCount();

        // Mobile menu toggle handled by navbar.js

        // Mobile auth visibility handled by navbar.js

        // Navbar scroll effect (only add scrolled class, no hiding)
        window.addEventListener("scroll", () => {
          const currentScrollY = window.scrollY;

          if (currentScrollY > 100) {
            navbar.classList.add("scrolled");
          } else {
            navbar.classList.remove("scrolled");
          }
        });

        // Auth system
        try {
          const token = localStorage.getItem("authToken");
          const navbarAuth = document.getElementById("navbarAuth");

          if (token && navbarAuth) {
            const loginBtn = navbarAuth.querySelector('a[href="login.html"]');
            if (loginBtn) {
              loginBtn.innerHTML = `
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                Profile
              `;
              loginBtn.href = "profile.html";
            }
          }
        } catch (error) {
          console.warn("Auth system initialization failed:", error);
        }

        // Background Animation System - now using shared module
        // Animations will be auto-initialized by background-animations.js
      });
    </script><script src="../javascript/navbar.js"></script><script src="../javascript/cart-utils.js"></script><script src="../javascript/background-animations.js"></script><script src="../javascript/button-refresh.js"></script><script>
      // Print order submission handler
      let isSubmitting = false;
      document.getElementById("submitPrintOrder").addEventListener("click", async function (e) {
        e.preventDefault();
        e.stopPropagation();
        
        // Prevent multiple submissions
        if (isSubmitting) {
          console.log('Form is already being submitted, please wait...');
          return;
        }
        
        isSubmitting = true;
        console.log('Print order submission started');
        
        // Show submission notification
        showNotification('Submitting your print order...', 'info', 3000);
          
          const form = document.getElementById("printForm");
          
          // Check if form is valid before proceeding
          if (!form.checkValidity()) {
            console.log('Form validation failed');
            // Find all invalid fields and log them
            const invalidFields = form.querySelectorAll(':invalid');
            console.log('Invalid fields:', invalidFields);
            invalidFields.forEach(field => {
              console.log('Invalid field:', field.name, field.type, field.validity);
            });
            
            // Find the first invalid field and focus on it
            const firstInvalid = form.querySelector(':invalid');
            if (firstInvalid) {
              firstInvalid.focus();
              firstInvalid.reportValidity();
            }
            isSubmitting = false; // Reset flag
            return;
          }
          
          console.log('Form validation passed, preparing data');
          const formData = new FormData();
          
          // Add all form fields
          const token = localStorage.getItem('authToken');
          if (token) {
            // User is logged in - use their complete profile data from database
            // But if contact number is empty, use visible field (fallback case)
            const contactNumber = document.getElementById('hiddenContactNumber').value || form.contactNumber.value;
            
            formData.append('userName', document.getElementById('hiddenUserName').value);
            formData.append('email', document.getElementById('hiddenEmail').value);
            formData.append('contactNumber', contactNumber);
            
            // Add userId for backend reference
            try {
              const payload = JSON.parse(atob(token.split('.')[1]));
              formData.append('userId', payload.sub);
            } catch (e) {
              console.warn('Could not extract userId from token');
            }
          } else {
            // User is not logged in - use visible form fields
            const userNameField = form.querySelector('input[name="userName"]');
            const emailField = form.querySelector('input[name="email"]');
            const contactNumberField = form.querySelector('input[name="contactNumber"]');
            
            console.log('Non-logged-in user form fields debug:');
            console.log('userName field found:', !!userNameField);
            console.log('email field found:', !!emailField);
            console.log('contactNumber field found:', !!contactNumberField);
            
            if (userNameField) console.log('userName value:', userNameField.value);
            if (emailField) console.log('email value:', emailField.value);
            if (contactNumberField) console.log('contactNumber value:', contactNumberField.value);
            
            formData.append('userName', userNameField ? userNameField.value : '');
            formData.append('email', emailField ? emailField.value : '');
            formData.append('contactNumber', contactNumberField ? contactNumberField.value : '');
          }
          formData.append('paperSize', form.querySelector('select[name="paperSize"]').value);
          formData.append('colorOption', form.querySelector('select[name="colorOption"]').value);
          formData.append('binding', form.querySelector('select[name="binding"]').value);
          formData.append('copies', form.querySelector('input[name="copies"]').value);
          formData.append('finishing', form.querySelector('select[name="finishing"]').value);
          formData.append('deliveryMethod', form.querySelector('input[name="deliveryMethod"]:checked').value);
          formData.append('paymentMethod', form.querySelector('input[name="paymentMethod"]:checked').value);
          
          // Only add delivery address if not store pickup
          const deliveryMethod = form.querySelector('input[name="deliveryMethod"]:checked').value;
          if (deliveryMethod !== 'Pickup') {
            formData.append('deliveryAddress', form.querySelector('textarea[name="deliveryAddress"]').value);
          } else {
            formData.append('deliveryAddress', 'Store Pickup - Will be notified when ready');
          }
          
          // Add additional notes if custom finishing
          if (form.querySelector('select[name="finishing"]').value === 'custom' && form.querySelector('textarea[name="additionalNotes"]').value) {
            formData.append('additionalNotes', form.querySelector('textarea[name="additionalNotes"]').value);
          }
          
          // Add file
          const documentInput = form.querySelector('input[name="document"]');
          if (documentInput && documentInput.files.length > 0) {
            formData.append('document', documentInput.files[0]);
          }

          // Add calculated estimated price from frontend
          const estimatedPriceElement = document.getElementById('estimatedPrice');
          if (estimatedPriceElement) {
            const priceText = estimatedPriceElement.textContent;
            const priceMatch = priceText.match(/Rs\.\s*(\d+)/);
            if (priceMatch) {
              const calculatedPrice = parseInt(priceMatch[1]);
              formData.append('estimatedPrice', calculatedPrice);
              console.log('Adding calculated estimated price:', calculatedPrice);
            }
          }

          // Debug: Log form data being sent
          console.log('Form data being sent:');
          for (let [key, value] of formData.entries()) {
            console.log(key + ':', value);
          }

          try {
            console.log('Sending request to /api/print-orders');
            
            // Show upload progress
            const submitButton = document.getElementById('submitPrintOrder');
            const originalText = submitButton.textContent;
            submitButton.innerHTML = `
                <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Uploading...
            `;
            submitButton.disabled = true;
            
            const response = await fetch("/api/print-orders", {
              method: "POST",
              body: formData
            });
            
            console.log('Response received:', response.status, response.statusText);
            
            let result;
            try {
              result = await response.json();
              console.log('Response data:', result);
            } catch (jsonError) {
              console.error('JSON parsing error:', jsonError);
              console.log('Raw response text:', await response.text());
              throw new Error('Invalid response format from server');
            }
            
            if (response.ok && result.success) {
              // Show success modal instead of alert
              showPrintOrderSuccessModal(result.data._id);
              
              // Reset form
              form.reset();
              document.getElementById('estimatedPrice').textContent = 'Rs. 0';
              document.getElementById('additionalNotesContainer').style.display = 'none';
              
              // Clear file preview after successful submission
              hideFilePreview();
              
              // Reset submission flag and button
              isSubmitting = false;
              submitButton.textContent = originalText;
              submitButton.disabled = false;
            } else {
              // Show detailed validation errors
              let errorMessage = result.error || 'Failed to submit print order';
              if (result.details && Array.isArray(result.details) && result.details.length > 0) {
                errorMessage += '\n\nValidation errors:\n';
                result.details.forEach(error => {
                  errorMessage += `- ${error.msg} (field: ${error.param})\n`;
                });
              } else if (result.details && !Array.isArray(result.details)) {
                console.error('Details is not an array:', result.details);
                errorMessage += '\n\nDetails: ' + JSON.stringify(result.details);
              }
              throw new Error(errorMessage);
            }
          } catch (err) {
            console.error('Print order submission error:', err);
            showErrorModal("Failed to submit print order: " + err.message);
          } finally {
            // Reset submission flag and button in all cases
            isSubmitting = false;
            if (typeof submitButton !== 'undefined') {
              submitButton.textContent = originalText;
              submitButton.disabled = false;
            }
          }
        });

        // Delivery pricing management
        async function getDeliveryPrice() {
            try {
                const response = await fetch('/api/delivery-settings');
                if (response.ok) {
                    const data = await response.json();
                    return data.data?.localDeliveryPrice || 0;
                }
            } catch (error) {
                console.error('Error fetching delivery settings:', error);
            }
            return 0;
        }

        async function updateDeliveryPrice() {
            const price = await getDeliveryPrice();
            const priceElement = document.getElementById('printDeliveryPrice');
            if (priceElement) {
                if (price > 0) {
                    priceElement.textContent = `LKR ${price.toFixed(2)}`;
                } else {
                    priceElement.textContent = 'Free';
                }
            }
            
            // Update pricing data
            pricingData.delivery[0].price = price;
            
            // Recalculate price if pricing calculator is active
            if (typeof calculatePrice === 'function') {
                calculatePrice();
            }
        }

        async function loadDeliverySettings() {
            await updateDeliveryPrice();
            updateDeliveryRadius();
        }

        async function updateDeliveryRadius() {
            try {
                const response = await fetch('/api/delivery-settings');
                if (response.ok) {
                    const data = await response.json();
                    const radius = data.data?.deliveryRadius || 10;
                    
                    const radiusElement = document.getElementById('printDeliveryRadius');
                    if (radiusElement) {
                        radiusElement.textContent = `${radius} km`;
                    }
                }
            } catch (error) {
                console.error('Error loading delivery radius:', error);
            }
        }

        // Listen for delivery settings updates from admin panel
        window.addEventListener('deliverySettingsUpdated', function(event) {
            console.log('Delivery settings updated, refreshing print page...');
            loadDeliverySettings();
        });

        // Function to use saved address from user profile (global function)
        async function useSavedAddress() {
            try {
                const deliveryAddressField = document.getElementById('deliveryAddress');
                const notification = document.getElementById('savedAddressNotification');
                const useBtn = document.getElementById('useSavedAddressBtn');
                
                // Show loading state
                useBtn.innerHTML = '⏳ Loading...';
                useBtn.disabled = true;
                
                // Try to get user data from localStorage first
                let userData = localStorage.getItem('userData');
                if (userData) {
                    try {
                        userData = JSON.parse(userData);
                    } catch (e) {
                        console.error('Error parsing user data from localStorage:', e);
                        userData = null;
                    }
                }
                
                // If no localStorage data, try to fetch from API
                if (!userData || !userData.address) {
                    const token = localStorage.getItem('token') || localStorage.getItem('authToken');
                    console.log('Token found:', !!token);
                    
                    if (token) {
                        try {
                            const response = await fetch('/api/profile', {
                                headers: {
                                    'Authorization': `Bearer ${token}`
                                }
                            });
                            
                            console.log('API response status:', response.status);
                            
                            if (response.ok) {
                                const profileData = await response.json();
                                userData = profileData.data || profileData;
                                console.log('Fetched user data from API:', userData);
                            } else {
                                console.error('API request failed:', response.status, response.statusText);
                                const errorText = await response.text();
                                console.error('Error response:', errorText);
                            }
                        } catch (apiError) {
                            console.error('API request error:', apiError);
                        }
                    } else {
                        console.log('No token found in localStorage');
                    }
                }
                
                console.log('User data retrieved:', userData);
                console.log('Address field value:', userData?.address);
                
                if (userData && userData.address && userData.address.trim() !== '') {
                    // Fill the delivery address field
                    deliveryAddressField.value = userData.address;
                    
                    // Show success notification
                    notification.innerHTML = '<p class="text-sm text-green-700">✅ Address loaded from your profile!</p>';
                    notification.classList.remove('hidden');
                    
                    // Hide notification after 3 seconds
                    setTimeout(() => {
                        notification.classList.add('hidden');
                    }, 3000);
                    
                    console.log('Address loaded from user profile:', userData.address);
                } else {
                    // Show error notification with more helpful message
                    const hasUserData = userData && Object.keys(userData).length > 0;
                    const hasEmptyAddress = userData && userData.address === '';
                    
                    let errorMessage = '❌ No saved address found. Please enter your address manually.';
                    if (hasUserData && hasEmptyAddress) {
                        errorMessage = '❌ You haven\'t saved an address in your profile yet. <a href="profile.html" class="underline text-blue-600 hover:text-blue-800">Update your profile</a> or enter your address manually.';
                    } else if (!hasUserData) {
                        errorMessage = '❌ Could not retrieve your profile data. Please enter your address manually.';
                    }
                    
                    notification.innerHTML = `<p class="text-sm text-red-700">${errorMessage}</p>`;
                    notification.classList.remove('hidden');
                    
                    // Hide notification after 5 seconds (longer for error messages)
                    setTimeout(() => {
                        notification.classList.add('hidden');
                        notification.innerHTML = '<p class="text-sm text-green-700">✅ Address loaded from your profile!</p>';
                    }, 5000);
                }
            } catch (error) {
                console.error('Error loading saved address:', error);
                
                // Show error notification
                const notification = document.getElementById('savedAddressNotification');
                notification.innerHTML = '<p class="text-sm text-red-700">❌ Error loading address. Please enter manually.</p>';
                notification.classList.remove('hidden');
                
                // Hide notification after 3 seconds
                setTimeout(() => {
                    notification.classList.add('hidden');
                    notification.innerHTML = '<p class="text-sm text-green-700">✅ Address loaded from your profile!</p>';
                }, 3000);
            } finally {
                // Reset button state
                const useBtn = document.getElementById('useSavedAddressBtn');
                useBtn.innerHTML = '📍 Use Saved Address';
                useBtn.disabled = false;
            }
        }

        // Load delivery settings on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadDeliverySettings();
            initializePricingCalculator();
        });

        // Dynamic Pricing Calculator
        function initializePricingCalculator() {
            // Use existing pricingData from the page

            // Get form elements
            const paperSizeSelect = document.getElementById('paperSize');
            const colorOptionSelect = document.getElementById('colorOption');
            const bindingSelect = document.getElementById('binding');
            const copiesInput = document.getElementById('copies');
            const finishingSelect = document.getElementById('finishing');

            // Get display elements
            const priceCalculator = document.getElementById('priceCalculator');
            const priceBreakdown = document.getElementById('priceBreakdown');
            const basePriceEl = document.getElementById('basePrice');
            const colorUpgradeEl = document.getElementById('colorUpgrade');
            const bindingCostEl = document.getElementById('bindingCost');
            const finishingCostEl = document.getElementById('finishingCost');
            const totalPriceEl = document.getElementById('totalPrice');

            // Calculate and display price using existing pricingData
            function calculatePrice() {
                const paperSize = paperSizeSelect.value;
                const colorOption = colorOptionSelect.value;
                const binding = bindingSelect.value;
                const copies = parseInt(copiesInput.value) || 1;
                const finishing = finishingSelect.value;

                // Check if at least one option is selected
                if (!paperSize && !colorOption && !binding && !finishing) {
                    priceCalculator.style.display = 'block';
                    priceBreakdown.classList.add('hidden');
                    return;
                }

                // Show partial pricing even if not all fields are filled
                const hasAnySelection = paperSize || colorOption || binding || finishing;
                if (!hasAnySelection) {
                    priceCalculator.style.display = 'block';
                    priceBreakdown.classList.add('hidden');
                    return;
                }

                let totalPrice = 0;
                let printCostPerCopy = 0;
                let bindingCost = 0;
                let finishingCost = 0;
                let deliveryCost = 0;

                // Find paper size pricing using existing pricingData
                if (paperSize) {
                    const sizeData = pricingData.paperSizes.find(s => s.size === paperSize);
                    if (sizeData) {
                        if (colorOption) {
                            switch (colorOption) {
                                case 'normal_color':
                                    printCostPerCopy = sizeData.normal_color;
                                    break;
                                case 'laser_color':
                                    printCostPerCopy = sizeData.laser_color;
                                    break;
                                case 'bw_single':
                                    printCostPerCopy = sizeData.bw_single;
                                    break;
                                case 'bw_double':
                                    printCostPerCopy = sizeData.bw_double;
                                    break;
                            }
                        } else {
                            // If no color selected, show the cheapest option (bw_single)
                            printCostPerCopy = sizeData.bw_single;
                        }
                        totalPrice += printCostPerCopy * copies;
                    }
                }

                // Add binding cost (skip if "None")
                if (binding && binding !== "None") {
                    const bindingData = pricingData.binding.find(b => b.type === binding);
                    if (bindingData) {
                        bindingCost = bindingData.price;
                        totalPrice += bindingCost;
                    }
                }

                // Add finishing cost (skip if "None")
                if (finishing && finishing !== "None") {
                    const finishingData = pricingData.finishing.find(f => f.type === finishing);
                    if (finishingData) {
                        finishingCost = finishingData.price;
                        totalPrice += finishingCost;
                    }
                }

                // Add delivery cost
                const deliveryMethod = document.querySelector('input[name="deliveryMethod"]:checked')?.value;
                if (deliveryMethod) {
                    const deliveryData = pricingData.delivery.find(d => d.type === deliveryMethod);
                    if (deliveryData) {
                        deliveryCost = deliveryData.price;
                        totalPrice += deliveryCost;
                    }
                }

                // Update display
                priceCalculator.style.display = 'none';
                priceBreakdown.classList.remove('hidden');

                // Show individual option costs with clear pricing breakdown
                if (paperSize) {
                    const sizeData = pricingData.paperSizes.find(s => s.size === paperSize);
                    if (sizeData && colorOption) {
                        // Show exact price for selected paper size and color
                        basePriceEl.textContent = `Rs. ${printCostPerCopy} (${paperSize} ${colorOption.replace('_', ' ').replace('bw', 'B&W').replace('single', 'Single').replace('double', 'Double')})`;
                    } else if (sizeData) {
                        // Show paper size with cheapest color option
                        const cheapestPrice = sizeData.bw_single;
                        basePriceEl.textContent = `Rs. ${cheapestPrice} (${paperSize} B&W Single - est.)`;
                    } else {
                        basePriceEl.textContent = `Select paper size`;
                    }
                } else {
                    basePriceEl.textContent = `Select paper size`;
                }

                if (colorOption) {
                    const sizeData = pricingData.paperSizes.find(s => s.size === paperSize);
                    if (sizeData) {
                        const colorPrice = sizeData[colorOption];
                        const basePrice = sizeData.bw_single;
                        const colorUpgrade = colorPrice - basePrice;
                        if (colorUpgrade > 0) {
                            colorUpgradeEl.textContent = `+Rs. ${colorUpgrade} (${colorOption.replace('_', ' ').replace('bw', 'B&W').replace('single', 'Single').replace('double', 'Double')} upgrade)`;
                        } else {
                            colorUpgradeEl.textContent = `Rs. 0 (${colorOption.replace('_', ' ').replace('bw', 'B&W').replace('single', 'Single').replace('double', 'Double')})`;
                        }
                    } else {
                        colorUpgradeEl.textContent = `Select color option`;
                    }
                } else {
                    colorUpgradeEl.textContent = `Select color option`;
                }

                if (binding && binding !== "None") {
                    bindingCostEl.textContent = `+Rs. ${bindingCost} (${binding})`;
                } else {
                    bindingCostEl.textContent = `+Rs. 0 (No binding)`;
                }

                if (finishing && finishing !== "None") {
                    finishingCostEl.textContent = `+Rs. ${finishingCost} (${finishing})`;
                } else {
                    finishingCostEl.textContent = `+Rs. 0 (No finishing)`;
                }

                // Show total with appropriate messaging
                if (totalPrice > 0) {
                    totalPriceEl.textContent = `Rs. ${totalPrice}`;
                    if (!paperSize || !colorOption || !binding || !finishing) {
                        totalPriceEl.textContent += ` (partial)`;
                    }
                } else {
                    totalPriceEl.textContent = `Select options to see price`;
                }

                // Show/hide partial warning
                const partialWarning = document.getElementById('partialWarning');
                if (partialWarning) {
                    if (totalPrice > 0 && (!paperSize || !colorOption || !binding || !finishing)) {
                        partialWarning.classList.remove('hidden');
                    } else {
                        partialWarning.classList.add('hidden');
                    }
                }

                // Update estimated price for form submission
                const estimatedPriceEl = document.getElementById('estimatedPrice');
                if (estimatedPriceEl) {
                    estimatedPriceEl.textContent = `Rs. ${totalPrice}`;
                }
            }

            // Add event listeners
            if (paperSizeSelect) paperSizeSelect.addEventListener('change', calculatePrice);
            if (colorOptionSelect) colorOptionSelect.addEventListener('change', calculatePrice);
            if (bindingSelect) bindingSelect.addEventListener('change', calculatePrice);
            if (copiesInput) copiesInput.addEventListener('input', calculatePrice);
            if (finishingSelect) finishingSelect.addEventListener('change', calculatePrice);

            // Add delivery method listeners
            const deliveryMethods = document.querySelectorAll('input[name="deliveryMethod"]');
            deliveryMethods.forEach(method => {
                method.addEventListener('change', function() {
                    calculatePrice();
                    toggleDeliveryAddress();
                });
            });
            
            // Function to toggle delivery address field and payment options based on delivery method
            function toggleDeliveryAddress() {
                const deliveryAddressLabel = document.getElementById('deliveryAddressLabel');
                const deliveryAddress = document.getElementById('deliveryAddress');
                const storePickupNotification = document.getElementById('storePickupNotification');
                const homeDeliveryPayment = document.getElementById('homeDeliveryPayment');
                const storePickupPayment = document.getElementById('storePickupPayment');
                const selectedMethod = document.querySelector('input[name="deliveryMethod"]:checked');
                
                if (selectedMethod && selectedMethod.value === 'Pickup') {
                    // Hide delivery address field and show store pickup notification
                    deliveryAddressLabel.style.display = 'none';
                    deliveryAddress.required = false;
                    storePickupNotification.classList.remove('hidden');
                    
                    // Show store pickup payment options
                    homeDeliveryPayment.classList.add('hidden');
                    storePickupPayment.classList.remove('hidden');
                    
                    // Set default payment method for store pickup
                    const storePickupCod = storePickupPayment.querySelector('input[value="Cash on Delivery"]');
                    if (storePickupCod) {
                        storePickupCod.checked = true;
                    }
                } else {
                    // Show delivery address field and hide store pickup notification
                    deliveryAddressLabel.style.display = 'flex';
                    deliveryAddress.required = true;
                    storePickupNotification.classList.add('hidden');
                    
                    // Show home delivery payment options
                    homeDeliveryPayment.classList.remove('hidden');
                    storePickupPayment.classList.add('hidden');
                    
                    // Set default payment method for home delivery
                    const homeDeliveryCod = homeDeliveryPayment.querySelector('input[value="Cash on Delivery"]');
                    if (homeDeliveryCod) {
                        homeDeliveryCod.checked = true;
                    }
                }
            }


            // Initial calculation and setup
            calculatePrice();
            toggleDeliveryAddress(); // Set initial state
        }

        // Modern Notification System
        function showNotification(message, type = 'info', duration = 5000) {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                warning: 'bg-yellow-500',
                info: 'bg-blue-500'
            };
            
            const icons = {
                success: '✓',
                error: '✕',
                warning: '⚠',
                info: 'ℹ'
            };
            
            notification.className = `${colors[type]} text-white px-6 py-4 rounded-lg shadow-lg transform transition-all duration-300 translate-x-full opacity-0`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <span class="text-xl mr-3">${icons[type]}</span>
                    <span class="flex-1">${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            container.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-full', 'opacity-0');
            }, 100);
            
            // Auto remove
            setTimeout(() => {
                notification.classList.add('translate-x-full', 'opacity-0');
                setTimeout(() => notification.remove(), 300);
            }, duration);
        }

        // Print Order Success Modal Functions
        function showPrintOrderSuccessModal(orderId) {
            const modal = document.getElementById('printOrderSuccessModal');
            const content = document.getElementById('successModalContent');
            const orderIdElement = document.getElementById('successOrderId');
            
            orderIdElement.textContent = orderId;
            modal.classList.remove('hidden');
            
            // Animate in
            setTimeout(() => {
                content.classList.remove('scale-95', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            }, 100);
        }

        function closePrintOrderSuccessModal() {
            const modal = document.getElementById('printOrderSuccessModal');
            const content = document.getElementById('successModalContent');
            
            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-95', 'opacity-0');
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        function viewPrintOrders() {
            closePrintOrderSuccessModal();
            // Redirect to orders page or open orders modal
            window.location.href = 'profile.html#orders';
        }

        // Error Modal Functions
        function showErrorModal(message) {
            const modal = document.getElementById('errorModal');
            const content = document.getElementById('errorModalContent');
            const messageElement = document.getElementById('errorMessage');
            
            messageElement.textContent = message;
            modal.classList.remove('hidden');
            
            // Animate in
            setTimeout(() => {
                content.classList.remove('scale-95', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            }, 100);
        }

        function closeErrorModal() {
            const modal = document.getElementById('errorModal');
            const content = document.getElementById('errorModalContent');
            
            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-95', 'opacity-0');
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        // PDF Fullscreen function
        function openPDFFullscreen(file) {
            const pdfUrl = URL.createObjectURL(file);
            const newWindow = window.open(pdfUrl, '_blank', 'width=1200,height=800,scrollbars=yes,resizable=yes');
            
            if (newWindow) {
                newWindow.document.title = file.name;
                // Clean up the URL after a delay
                setTimeout(() => {
                    URL.revokeObjectURL(pdfUrl);
                }, 1000);
            } else {
                showNotification('Please allow popups to view PDF files', 'warning');
                URL.revokeObjectURL(pdfUrl);
            }
        }

        // DOCX Fullscreen function
        function openDOCXFullscreen(file) {
            const docUrl = URL.createObjectURL(file);
            const newWindow = window.open(docUrl, '_blank', 'width=1200,height=800,scrollbars=yes,resizable=yes');
            
            if (newWindow) {
                newWindow.document.title = file.name;
                // Clean up the URL after a delay
                setTimeout(() => {
                    URL.revokeObjectURL(docUrl);
                }, 1000);
            } else {
                showNotification('Please allow popups to view document files', 'warning');
                URL.revokeObjectURL(docUrl);
            }
        }

        // Fullscreen modal functions
        function openFullscreenModal(file) {
            const modal = document.getElementById('fullscreenModal');
            const fullscreenImage = document.getElementById('fullscreenImage');
            const fullscreenFileName = document.getElementById('fullscreenFileName');
            const fullscreenFileSize = document.getElementById('fullscreenFileSize');
            const fullscreenDimensions = document.getElementById('fullscreenDimensions');
            const fullscreenFileType = document.getElementById('fullscreenFileType');
            const imageInfo = document.getElementById('imageInfo');

            if (file.type.startsWith('image/')) {
                fullscreenImage.src = URL.createObjectURL(file);
                fullscreenImage.alt = file.name;
                
                // Set file info
                if (fullscreenFileName) fullscreenFileName.textContent = file.name;
                if (fullscreenFileSize) fullscreenFileSize.textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB`;
                if (fullscreenFileType) fullscreenFileType.textContent = file.type;
                
                // Get image dimensions
                fullscreenImage.onload = function() {
                    const dimensions = `${this.naturalWidth} × ${this.naturalHeight}`;
                    if (fullscreenDimensions) fullscreenDimensions.textContent = dimensions;
                    if (imageInfo) imageInfo.classList.remove('hidden');
                };
                
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeFullscreenModal() {
            const modal = document.getElementById('fullscreenModal');
            modal.classList.add('hidden');
            document.body.style.overflow = 'auto';
            
            // Reset zoom
            const fullscreenImage = document.getElementById('fullscreenImage');
            if (fullscreenImage) {
                fullscreenImage.style.transform = 'scale(1)';
            }
        }

        // Modal event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const modal = document.getElementById('fullscreenModal');
            const closeBtn = document.getElementById('closeFullscreen');
            const zoomInBtn = document.getElementById('zoomIn');
            const zoomOutBtn = document.getElementById('zoomOut');
            const resetZoomBtn = document.getElementById('resetZoom');
            const fullscreenImage = document.getElementById('fullscreenImage');

            if (closeBtn) {
                closeBtn.addEventListener('click', closeFullscreenModal);
            }

            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closeFullscreenModal();
                    }
                });
            }

            // Zoom functionality
            let currentZoom = 1;
            const zoomStep = 0.2;
            const maxZoom = 3;
            const minZoom = 0.5;

            if (zoomInBtn && fullscreenImage) {
                zoomInBtn.addEventListener('click', function() {
                    if (currentZoom < maxZoom) {
                        currentZoom += zoomStep;
                        fullscreenImage.style.transform = `scale(${currentZoom})`;
                    }
                });
            }

            if (zoomOutBtn && fullscreenImage) {
                zoomOutBtn.addEventListener('click', function() {
                    if (currentZoom > minZoom) {
                        currentZoom -= zoomStep;
                        fullscreenImage.style.transform = `scale(${currentZoom})`;
                    }
                });
            }

            if (resetZoomBtn && fullscreenImage) {
                resetZoomBtn.addEventListener('click', function() {
                    currentZoom = 1;
                    fullscreenImage.style.transform = 'scale(1)';
                });
            }

            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (!modal.classList.contains('hidden')) {
                    if (e.key === 'Escape') {
                        closeFullscreenModal();
                    } else if (e.key === '+' || e.key === '=') {
                        if (currentZoom < maxZoom) {
                            currentZoom += zoomStep;
                            fullscreenImage.style.transform = `scale(${currentZoom})`;
                        }
                    } else if (e.key === '-') {
                        if (currentZoom > minZoom) {
                            currentZoom -= zoomStep;
                            fullscreenImage.style.transform = `scale(${currentZoom})`;
                        }
                    } else if (e.key === '0') {
                        currentZoom = 1;
                        fullscreenImage.style.transform = 'scale(1)';
                    }
                }
            });
        });
    </script>

    <!-- Full Screen Image Modal -->
    <div id="fullscreenModal" class="fixed inset-0 bg-black bg-opacity-90 z-50 hidden flex items-center justify-center p-4">
        <div class="relative max-w-7xl max-h-full w-full h-full flex items-center justify-center">
            <!-- Close button -->
            <button id="closeFullscreen" class="absolute top-4 right-4 z-10 text-white hover:text-gray-300 transition-colors">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            
            <!-- Image container -->
            <div class="relative max-w-full max-h-full flex items-center justify-center">
                <img id="fullscreenImage" class="max-w-full max-h-full object-contain" alt="Full screen preview">
            </div>
            
            <!-- Image info overlay -->
            <div id="imageInfo" class="absolute bottom-4 left-4 right-4 bg-black bg-opacity-75 text-white p-4 rounded-lg hidden">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                    <div><span class="font-medium">File:</span> <span id="fullscreenFileName"></span></div>
                    <div><span class="font-medium">Size:</span> <span id="fullscreenFileSize"></span></div>
                    <div><span class="font-medium">Dimensions:</span> <span id="fullscreenDimensions"></span></div>
                    <div><span class="font-medium">Type:</span> <span id="fullscreenFileType"></span></div>
                </div>
            </div>
            
            <!-- Zoom controls -->
            <div class="absolute top-4 left-4 flex flex-col gap-2">
                <button id="zoomIn" class="bg-black bg-opacity-50 text-white p-2 rounded hover:bg-opacity-75 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                </button>
                <button id="zoomOut" class="bg-black bg-opacity-50 text-white p-2 rounded hover:bg-opacity-75 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 12H6"></path>
                    </svg>
                </button>
                <button id="resetZoom" class="bg-black bg-opacity-50 text-white p-2 rounded hover:bg-opacity-75 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Modern Notification System -->
    <div id="notificationContainer" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- Print Order Success Modal -->
    <div id="printOrderSuccessModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full transform transition-all duration-300 scale-95 opacity-0" id="successModalContent">
            <div class="p-6">
                <!-- Success Icon -->
                <div class="flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full">
                    <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                
                <!-- Success Message -->
                <div class="text-center mb-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-2">Print Order Submitted!</h3>
                    <p class="text-gray-600 mb-4">Your print order has been successfully submitted and is being processed.</p>
                    <div class="bg-gray-50 rounded-lg p-3">
                        <p class="text-sm text-gray-700">
                            <span class="font-semibold">Order ID:</span> 
                            <span id="successOrderId" class="font-mono text-blue-600"></span>
                        </p>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="flex gap-3">
                    <button 
                        onclick="closePrintOrderSuccessModal()" 
                        class="flex-1 bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors"
                    >
                        Continue Shopping
                    </button>
                    <button 
                        onclick="viewPrintOrders()" 
                        class="flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-200 transition-colors"
                    >
                        View Orders
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Modal -->
    <div id="errorModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full transform transition-all duration-300 scale-95 opacity-0" id="errorModalContent">
            <div class="p-6">
                <!-- Error Icon -->
                <div class="flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full">
                    <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </div>
                
                <!-- Error Message -->
                <div class="text-center mb-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-2">Something Went Wrong</h3>
                    <p id="errorMessage" class="text-gray-600 mb-4">We encountered an error while processing your request.</p>
                </div>
                
                <!-- Action Buttons -->
                <div class="flex gap-3">
                    <button 
                        onclick="closeErrorModal()" 
                        class="flex-1 bg-red-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-red-700 transition-colors"
                    >
                        Try Again
                    </button>
                    <button 
                        onclick="closeErrorModal()" 
                        class="flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-200 transition-colors"
                    >
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

</body></html>
